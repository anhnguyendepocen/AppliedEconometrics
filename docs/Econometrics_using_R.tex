\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Lecture Note for Applied Econometrics},
            pdfauthor={Yuta Toyama},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Lecture Note for Applied Econometrics}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Yuta Toyama}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{Last updated: 2019/05/16}


\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{preface}{%
\chapter{Preface}\label{preface}}

Welcome to Applied Econometrics using R!

\hypertarget{about-this}{%
\section{About this}\label{about-this}}

This lecture note is maintained by Yuta Toyama.

\hypertarget{update-april-23-2019}{%
\section{Update: April 23, 2019}\label{update-april-23-2019}}

\begin{itemize}
\tightlist
\item
  Upload chapter 6 (review of statistics)
\end{itemize}

\hypertarget{update-april-16-2019}{%
\section{Update: April 16, 2019}\label{update-april-16-2019}}

\begin{itemize}
\tightlist
\item
  Update chapter 3 (basic programming)
\item
  Upload chapter 4 (Data frame)
\item
  Upload chapter 5 (Exercise 1)
\end{itemize}

\hypertarget{acknowledgement-as-of-april-16-2019}{%
\section{Acknowledgement (as of April 16, 2019)}\label{acknowledgement-as-of-april-16-2019}}

\begin{itemize}
\tightlist
\item
  Chapter 2 through 4 are largely based on Applied Statistics with \texttt{R}. \url{https://daviddalpiaz.github.io/appliedstats/}
\item
  Chapter 6 is based on ``Introduction to Econometrics with R''. \url{https://www.econometrics-with-r.org/index.html}
\end{itemize}

\hypertarget{introduction-to-the-course}{%
\chapter{Introduction to the course}\label{introduction-to-the-course}}

\hypertarget{what-is-econometrics}{%
\section{What is econometrics?}\label{what-is-econometrics}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Estimating economic relationships

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Demand curve \(\log(Q_{t})= \alpha_0 + \alpha_1 P_t + \epsilon_t\)
  \item
    Production function \(Y_{it}=A_{it}K_{it}^{\alpha}L_{it}^{\beta}\)
  \end{enumerate}
\item
  Testing economic theory

  \begin{itemize}
  \tightlist
  \item
    Does adverse selection exists in insurance markets?
  \item
    Are consumers rational?
  \end{itemize}
\item
  Determine the effect of a given intervention (causal inference)

  \begin{itemize}
  \tightlist
  \item
    What is the effect of increasing minimum wage on employment?
  \item
    Do mergers increase the output price?
  \item
    Does democracy cause economic growth? (a series of works by Acemoglu, Robinsohn, and their co-authors).
  \item
    Effects of going to private colleges on your future earnings.
  \item
    Note: Some questions may have underlying economic models, others may not.
  \end{itemize}
\item
  Describe the data (prediction/forecasting)

  \begin{itemize}
  \tightlist
  \item
    How does the distribution of wage look like?
  \item
    Relationship between electricity consumption and temperature (possibly nonlinear).
  \item
    Related to machine learning (ML).
  \end{itemize}
\end{enumerate}

\hypertarget{why-do-we-need-to-learn-computation}{%
\section{Why do we need to learn computation}\label{why-do-we-need-to-learn-computation}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Conduct statistical and empirical analysis using your own data set

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Construct the data set
  \item
    Describe the data
  \item
    Run regression or estimate an economic object
  \item
    Make tables and figures that show the results of your analysis.
  \end{enumerate}
\item
  Verify the econometric theory through numerical simulations.

  \begin{itemize}
  \tightlist
  \item
    Ex. Asymptotic theory considers the case when the sample size is large enough (i.e., \(N \rightarrow \infty\))

    \begin{itemize}
    \tightlist
    \item
      Law of large numbers, central limit theorem
    \item
      How well is the asymptotic approximation?
    \end{itemize}
  \item
    \textbf{Monte Carlo simulations}
  \end{itemize}
\end{enumerate}

\begin{itemize}
\tightlist
\item
  We will learn both aspects in this course.
\end{itemize}

\hypertarget{why-do-we-use-r}{%
\section{Why do we use R?}\label{why-do-we-use-r}}

\begin{itemize}
\tightlist
\item
  Many alternatives: Stata, Matlab, Python, etc\ldots{}
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Free software!!

  \begin{itemize}
  \tightlist
  \item
    Stata and Matlab are expensive.
  \item
    Though you can use Matlab through the campus license from this April.
  \end{itemize}
\item
  Good balance between flexibility in programming and easy-to-use for econometric analysis

  \begin{itemize}
  \tightlist
  \item
    Stata is easy to use for econometric analysis, but hard to write your own program.
  \item
    Matlab is the opposite.
  \item
    You can do everything with R, including data construction, regression analysis, and complicated structural estimation.
  \end{itemize}
\item
  Many users

  \begin{itemize}
  \tightlist
  \item
    Popular in engineering.
  \item
    Many packages being developed (especially important for recently popular tools. )
  \end{itemize}
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Note: Python seems also good, though I have not used it before.
\end{itemize}

\hypertarget{introduction-of-r-and-r-studio}{%
\chapter{\texorpdfstring{Introduction of \texttt{R} and \texttt{R\ studio}}{Introduction of R and R studio}}\label{introduction-of-r-and-r-studio}}

\hypertarget{getting-started}{%
\section{Getting Started}\label{getting-started}}

\begin{itemize}
\tightlist
\item
  You can use R/R studio in the PC room.
\item
  However, I strongly recommend you install R/Studio in your laptop and bring it to the class.
\item
  Install in the following order

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    R: \url{https://www.r-project.org/}
  \item
    Rstudio: \url{https://www.rstudio.com/}
  \end{enumerate}
\item
  Now open Rstudio.
\end{itemize}

\hypertarget{helps}{%
\section{Helps}\label{helps}}

\begin{itemize}
\tightlist
\item
  The RStudio team has developed \href{https://www.rstudio.com/resources/cheatsheets/}{a number of ``cheatsheets''} for working with both \texttt{R} and RStudio.
\item
  \href{http://www.rstudio.com/wp-content/uploads/2016/05/base-r.pdf}{This particular cheatsheet for Base \texttt{R}} will summarize many of the concepts in this document.
\end{itemize}

\hypertarget{quick-tour-of-rstudio}{%
\section{Quick tour of Rstudio}\label{quick-tour-of-rstudio}}

\begin{itemize}
\tightlist
\item
  There are four panels

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Source: Write your own code here.
  \item
    Console:
  \item
    Environment/History:
  \item
    Files/Plots/Packages/Help:
  \end{enumerate}
\item
  In the Source panel,

  \begin{itemize}
  \tightlist
  \item
    Write your own code.
  \item
    Save your code in \texttt{.R} file
  \item
    Click \texttt{Run} command to run your entire code.
  \end{itemize}
\item
  In the concole panel,

  \begin{itemize}
  \tightlist
  \item
    After clicking \texttt{Run} in the source panel, your code is evaluated.
  \item
    You can directly type your code here to implement.
  \end{itemize}
\end{itemize}

\hypertarget{basic-calculations}{%
\section{Basic Calculations}\label{basic-calculations}}

To get started, we'll use \texttt{R} like a simple calculator.

\hypertarget{addition-subtraction-multiplication-and-division}{%
\subsubsection*{Addition, Subtraction, Multiplication and Division}\label{addition-subtraction-multiplication-and-division}}
\addcontentsline{toc}{subsubsection}{Addition, Subtraction, Multiplication and Division}

\begin{longtable}[]{@{}lll@{}}
\toprule
Math & \texttt{R} & Result\tabularnewline
\midrule
\endhead
\(3 + 2\) & \texttt{3\ +\ 2} & 5\tabularnewline
\(3 - 2\) & \texttt{3\ -\ 2} & 1\tabularnewline
\(3 \cdot2\) & \texttt{3\ *\ 2} & 6\tabularnewline
\(3 / 2\) & \texttt{3\ /\ 2} & 1.5\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{exponents}{%
\subsubsection*{Exponents}\label{exponents}}
\addcontentsline{toc}{subsubsection}{Exponents}

\begin{longtable}[]{@{}lll@{}}
\toprule
Math & \texttt{R} & Result\tabularnewline
\midrule
\endhead
\(3^2\) & \texttt{3\ \^{}\ 2} & 9\tabularnewline
\(2^{(-3)}\) & \texttt{2\ \^{}\ (-3)} & 0.125\tabularnewline
\(100^{1/2}\) & \texttt{100\ \^{}\ (1\ /\ 2)} & 10\tabularnewline
\(\sqrt{100}\) & \texttt{sqrt(100)} & 10\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{mathematical-constants}{%
\subsubsection*{Mathematical Constants}\label{mathematical-constants}}
\addcontentsline{toc}{subsubsection}{Mathematical Constants}

\begin{longtable}[]{@{}lll@{}}
\toprule
Math & \texttt{R} & Result\tabularnewline
\midrule
\endhead
\(\pi\) & \texttt{pi} & 3.1415927\tabularnewline
\(e\) & \texttt{exp(1)} & 2.7182818\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{logarithms}{%
\subsubsection*{Logarithms}\label{logarithms}}
\addcontentsline{toc}{subsubsection}{Logarithms}

\begin{itemize}
\tightlist
\item
  Note that we will use \(\ln\) and \(\log\) interchangeably to mean the natural logarithm.
\item
  There is no \texttt{ln()} in \texttt{R}, instead it uses \texttt{log()} to mean the natural logarithm.
\end{itemize}

\begin{longtable}[]{@{}lll@{}}
\toprule
Math & \texttt{R} & Result\tabularnewline
\midrule
\endhead
\(\log(e)\) & \texttt{log(exp(1))} & 1\tabularnewline
\(\log_{10}(1000)\) & \texttt{log10(1000)} & 3\tabularnewline
\(\log_{2}(8)\) & \texttt{log2(8)} & 3\tabularnewline
\(\log_{4}(16)\) & \texttt{log(16,\ base\ =\ 4)} & 2\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{trigonometry}{%
\subsubsection*{Trigonometry}\label{trigonometry}}
\addcontentsline{toc}{subsubsection}{Trigonometry}

\begin{longtable}[]{@{}lll@{}}
\toprule
Math & \texttt{R} & Result\tabularnewline
\midrule
\endhead
\(\sin(\pi / 2)\) & \texttt{sin(pi\ /\ 2)} & 1\tabularnewline
\(\cos(0)\) & \texttt{cos(0)} & 1\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{getting-help}{%
\section{Getting Help}\label{getting-help}}

\begin{itemize}
\tightlist
\item
  In using \texttt{R} as a calculator, we have seen a number of functions: \texttt{sqrt()}, \texttt{exp()}, \texttt{log()} and \texttt{sin()}.
\item
  To get documentation about a function in \texttt{R}, simply put a question mark in front of the function name and RStudio will display the documentation, for example:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?log}
\NormalTok{?sin}
\NormalTok{?paste}
\NormalTok{?lm}
\end{Highlighting}
\end{Shaded}

\hypertarget{installing-packages}{%
\section{Installing Packages}\label{installing-packages}}

\begin{itemize}
\tightlist
\item
  One of the main strengths of \texttt{R} as an open-source project is its package system.
\item
  To install a package, use the \texttt{install.packages()} function.

  \begin{itemize}
  \tightlist
  \item
    Think of this as buying a recipe book from the store, bringing it home, and putting it on your shelf.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Once a package is installed, it must be loaded into your current \texttt{R} session before being used.

  \begin{itemize}
  \tightlist
  \item
    Think of this as taking the book off of the shelf and opening it up to read.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Once you close \texttt{R}, all the packages are closed and put back on the imaginary shelf.
\item
  The next time you open \texttt{R}, you do not have to install the package again, but you do have to load any packages you intend to use by invoking \texttt{library()}.
\end{itemize}

\hypertarget{data-and-programming}{%
\chapter{Data and Programming}\label{data-and-programming}}

\hypertarget{data-types}{%
\section{Data Types}\label{data-types}}

\texttt{R} has a number of basic data \emph{types}.

\begin{itemize}
\tightlist
\item
  Numeric

  \begin{itemize}
  \tightlist
  \item
    Also known as Double. The default type when dealing with numbers.
  \item
    Examples: \texttt{1}, \texttt{1.0}, \texttt{42.5}
  \end{itemize}
\item
  Logical

  \begin{itemize}
  \tightlist
  \item
    Two possible values: \texttt{TRUE} and \texttt{FALSE}
  \item
    You can also use \texttt{T} and \texttt{F}, but this is \emph{not} recommended.
  \item
    \texttt{NA} is also considered logical.
  \end{itemize}
\item
  Character

  \begin{itemize}
  \tightlist
  \item
    Examples: \texttt{"a"}, \texttt{"Statistics"}, \texttt{"1\ plus\ 2."}
  \end{itemize}
\end{itemize}

\hypertarget{data-structures}{%
\section{Data Structures}\label{data-structures}}

\begin{itemize}
\tightlist
\item
  \texttt{R} also has a number of basic data \emph{structures}.
\item
  A data structure is either

  \begin{itemize}
  \tightlist
  \item
    homogeneous (all elements are of the same data type)
  \item
    heterogeneous (elements can be of more than one data type).
  \end{itemize}
\end{itemize}

\begin{longtable}[]{@{}lll@{}}
\toprule
Dimension & \textbf{Homogeneous} & \textbf{Heterogeneous}\tabularnewline
\midrule
\endhead
1 & Vector & List\tabularnewline
2 & Matrix & Data Frame\tabularnewline
3+ & Array &\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{vectors}{%
\section{Vectors}\label{vectors}}

\hypertarget{basics-of-vectors}{%
\subsection{Basics of vectors}\label{basics-of-vectors}}

\begin{itemize}
\tightlist
\item
  Many operations in \texttt{R} make heavy use of \textbf{vectors}.

  \begin{itemize}
  \tightlist
  \item
    Vectors in \texttt{R} are indexed starting at \texttt{1}.
  \end{itemize}
\item
  The most common way to create a vector in \texttt{R} is using the \texttt{c()} function, which is short for ``combine.''"
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 5 7 8 9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  If we would like to store this vector in a \textbf{variable} we can do so with the \textbf{assignment} operator \texttt{=}.

  \begin{itemize}
  \tightlist
  \item
    The variable \texttt{x} now holds the vector we just created, and we can access the vector by typing \texttt{x}.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{9}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 5 7 8 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# The following does the same thing.}
\NormalTok{x <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{9}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 5 7 8 9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The operator \texttt{=} and \texttt{\textless{}-} work as an assignment operator.

  \begin{itemize}
  \tightlist
  \item
    You can use both. This does not matter usually.
  \item
    If you are interested in the weird cases where the difference matters, check out \href{http://www.burns-stat.com/documents/books/the-r-inferno/}{The R Inferno}.
  \end{itemize}
\item
  In \texttt{R} code the line starting with \texttt{\#} is \texttt{comment}, which is ignored when you run the fode.
\end{itemize}

\begin{itemize}
\tightlist
\item
  A vector based on a sequence of numbers.
\item
  The quickest and easiest way to do this is with the \texttt{:} operator, which creates a sequence of integers between two specified integers.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\DataTypeTok{y =} \DecValTok{1}\OperatorTok{:}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68
##  [69]  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85
##  [86]  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100
\end{verbatim}

\begin{itemize}
\tightlist
\item
  By putting parentheses around the assignment,

  \begin{itemize}
  \tightlist
  \item
    \texttt{R} both stores the vector in a variable called \texttt{y} and
  \item
    automatically outputs \texttt{y} to the console.
  \end{itemize}
\end{itemize}

\hypertarget{useful-functions-for-creating-vectors}{%
\subsection{Useful functions for creating vectors}\label{useful-functions-for-creating-vectors}}

\begin{itemize}
\tightlist
\item
  Use the \texttt{seq()} function for a more general sequence.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{seq}\NormalTok{(}\DataTypeTok{from =} \FloatTok{1.5}\NormalTok{, }\DataTypeTok{to =} \FloatTok{4.2}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.0 3.1
## [18] 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Here, the input labels \texttt{from}, \texttt{to}, and \texttt{by} are optional.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{seq}\NormalTok{(}\FloatTok{1.5}\NormalTok{, }\FloatTok{4.2}\NormalTok{, }\FloatTok{0.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.0 3.1
## [18] 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The \texttt{rep()} function repeat a single value a number of times.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rep}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\DataTypeTok{times =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "A" "A" "A" "A" "A" "A" "A" "A" "A" "A"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The \texttt{rep()} function can be used to repeat a vector some number of times.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rep}\NormalTok{(x, }\DataTypeTok{times =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1 3 5 7 8 9 1 3 5 7 8 9 1 3 5 7 8 9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We have now seen four different ways to create vectors:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    \texttt{c()}
  \item
    \texttt{:}
  \item
    \texttt{seq()}
  \item
    \texttt{rep()}
  \end{enumerate}
\item
  They are often used together.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{c}\NormalTok{(x, }\KeywordTok{rep}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DecValTok{3}\NormalTok{), }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{), }\DecValTok{42}\NormalTok{, }\DecValTok{2}\OperatorTok{:}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  1  3  5  7  8  9  1  3  5  7  9  1  3  5  7  9  1  3  5  7  9  1  2
## [24]  3 42  2  3  4
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The length of a vector can be obtained with the \texttt{length()} function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{length}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{length}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

\hypertarget{subsetting}{%
\subsection{Subsetting}\label{subsetting}}

\begin{itemize}
\tightlist
\item
  Use square brackets, \texttt{{[}{]}}, to obtain a subset of a vector.
\item
  We see that \texttt{x{[}1{]}} returns the first element.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 5 7 8 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We can also exclude certain indexes, in this case the second element.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\OperatorTok{-}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 5 7 8 9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We can subset based on a vector of indices.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{1}\OperatorTok{:}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 5 7
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We could instead use a vector of logical values.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OtherTok{TRUE}\NormalTok{, }\OtherTok{TRUE}\NormalTok{, }\OtherTok{FALSE}\NormalTok{, }\OtherTok{TRUE}\NormalTok{, }\OtherTok{TRUE}\NormalTok{, }\OtherTok{FALSE}\NormalTok{)}
\NormalTok{z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE  TRUE FALSE  TRUE  TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[z]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 7 8
\end{verbatim}

\hypertarget{vectorization}{%
\section{Vectorization}\label{vectorization}}

\begin{itemize}
\tightlist
\item
  One of the biggest strengths of \texttt{R} is its use of vectorized operations.

  \begin{itemize}
  \tightlist
  \item
    Frequently the lack of understanding of this concept leads of a belief that \texttt{R} is \emph{slow}.
  \item
    \texttt{R} is not the fastest language, but it has a reputation for being slower than it really is.)
  \end{itemize}
\item
  When a function like \texttt{log()} is called on a vector \texttt{x}, a vector is returned which has applied the function to each element of the vector \texttt{x}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{10}
\NormalTok{x }\OperatorTok{+}\StringTok{ }\DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  3  4  5  6  7  8  9 10 11
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  4  6  8 10 12 14 16 18 20
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \OperatorTok{^}\StringTok{ }\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]    2    4    8   16   32   64  128  256  512 1024
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sqrt}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751
##  [8] 2.828427 3.000000 3.162278
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{log}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101
##  [8] 2.0794415 2.1972246 2.3025851
\end{verbatim}

\hypertarget{logical-operators}{%
\section{Logical Operators}\label{logical-operators}}

\begin{longtable}[]{@{}llll@{}}
\toprule
Operator & Summary & Example & Result\tabularnewline
\midrule
\endhead
\texttt{x\ \textless{}\ y} & \texttt{x} less than \texttt{y} & \texttt{3\ \textless{}\ 42} & TRUE\tabularnewline
\texttt{x\ \textgreater{}\ y} & \texttt{x} greater than \texttt{y} & \texttt{3\ \textgreater{}\ 42} & FALSE\tabularnewline
\texttt{x\ \textless{}=\ y} & \texttt{x} less than or equal to \texttt{y} & \texttt{3\ \textless{}=\ 42} & TRUE\tabularnewline
\texttt{x\ \textgreater{}=\ y} & \texttt{x} greater than or equal to \texttt{y} & \texttt{3\ \textgreater{}=\ 42} & FALSE\tabularnewline
\texttt{x\ ==\ y} & \texttt{x}equal to \texttt{y} & \texttt{3\ ==\ 42} & FALSE\tabularnewline
\texttt{x\ !=\ y} & \texttt{x} not equal to \texttt{y} & \texttt{3\ !=\ 42} & TRUE\tabularnewline
\texttt{!x} & not \texttt{x} & \texttt{!(3\ \textgreater{}\ 42)} & TRUE\tabularnewline
\texttt{x\ \textbar{}\ y} & \texttt{x} or \texttt{y} & \texttt{(3\ \textgreater{}\ 42)\ \textbar{}\ TRUE} & TRUE\tabularnewline
\texttt{x\ \&\ y} & \texttt{x} and \texttt{y} & \texttt{(3\ \textless{}\ 4)\ \&\ (\ 42\ \textgreater{}\ 13)} & TRUE\tabularnewline
\bottomrule
\end{longtable}

\begin{itemize}
\tightlist
\item
  Logical operators are vectorized.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{>}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE FALSE  TRUE  TRUE  TRUE  TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{<}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE FALSE FALSE FALSE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{==}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE  TRUE FALSE FALSE FALSE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{!=}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{==}\StringTok{ }\DecValTok{3} \OperatorTok{&}\StringTok{ }\NormalTok{x }\OperatorTok{!=}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE FALSE FALSE FALSE FALSE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OperatorTok{==}\StringTok{ }\DecValTok{3} \OperatorTok{|}\StringTok{ }\NormalTok{x }\OperatorTok{!=}\StringTok{ }\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] TRUE TRUE TRUE TRUE TRUE TRUE
\end{verbatim}

\begin{itemize}
\tightlist
\item
  This is extremely useful for subsetting.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[x }\OperatorTok{>}\StringTok{ }\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5 7 8 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[x }\OperatorTok{!=}\StringTok{ }\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 5 7 8 9
\end{verbatim}

\hypertarget{short-exercise}{%
\subsubsection{Short exercise}\label{short-exercise}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Create the vector \(z = (1,2,1,2,1,2)\), which has the same length as \(x\).
\item
  Pick up the elements of \(x\) which corresponds to 1 in the vector \(z\).
\end{enumerate}

\hypertarget{matrices}{%
\section{Matrices}\label{matrices}}

\hypertarget{basics}{%
\subsection{Basics}\label{basics}}

\begin{itemize}
\tightlist
\item
  \texttt{R} can also be used for \textbf{matrix} calculations.

  \begin{itemize}
  \tightlist
  \item
    Matrices have rows and columns containing a single data type.
  \end{itemize}
\item
  Matrices can be created using the \texttt{matrix} function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{9}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4 5 6 7 8 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(x, }\DataTypeTok{nrow =} \DecValTok{3}\NormalTok{, }\DataTypeTok{ncol =} \DecValTok{3}\NormalTok{)}
\NormalTok{X}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We are using two different variables:

  \begin{itemize}
  \tightlist
  \item
    lower case \texttt{x}, which stores a vector and
  \item
    capital \texttt{X}, which stores a matrix.
  \end{itemize}
\item
  By default the \texttt{matrix} function reorders a vector into columns, but we can also tell \texttt{R} to use rows instead.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(x, }\DataTypeTok{nrow =} \DecValTok{3}\NormalTok{, }\DataTypeTok{ncol =} \DecValTok{3}\NormalTok{, }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  a matrix of a specified dimension where every element is the same, in this case \texttt{0}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Z =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{Z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4]
## [1,]    0    0    0    0
## [2,]    0    0    0    0
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Matrices can be subsetted using square brackets, \texttt{{[}{]}}.
\item
  However, since matrices are two-dimensional, we need to specify both a row and a column when subsetting.
\item
  Here we get the element in the first row and the second column.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We could also subset an entire row or column.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X[}\DecValTok{1}\NormalTok{, ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 4 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X[, }\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4 5 6
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Matrices can also be created by combining vectors as columns, using \texttt{cbind}, or combining vectors as rows, using \texttt{rbind}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{9}
\KeywordTok{rev}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9 8 7 6 5 4 3 2 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 1 1 1 1 1 1 1 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rbind}\NormalTok{(x, }\KeywordTok{rev}\NormalTok{(x), }\KeywordTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## x    1    2    3    4    5    6    7    8    9
##      9    8    7    6    5    4    3    2    1
##      1    1    1    1    1    1    1    1    1
\end{verbatim}

\begin{itemize}
\tightlist
\item
  When using \texttt{rbind} and \texttt{cbind} you can specify ``argument'' names that will be used as column names.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{cbind}\NormalTok{(}\DataTypeTok{col_1 =}\NormalTok{ x, }\DataTypeTok{col_2 =} \KeywordTok{rev}\NormalTok{(x), }\DataTypeTok{col_3 =} \KeywordTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{9}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       col_1 col_2 col_3
##  [1,]     1     9     1
##  [2,]     2     8     1
##  [3,]     3     7     1
##  [4,]     4     6     1
##  [5,]     5     5     1
##  [6,]     6     4     1
##  [7,]     7     3     1
##  [8,]     8     2     1
##  [9,]     9     1     1
\end{verbatim}

\hypertarget{matrix-calculations}{%
\subsection{Matrix calculations}\label{matrix-calculations}}

\begin{itemize}
\tightlist
\item
  Perform matrix calculations.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{1}\OperatorTok{:}\DecValTok{9}
\NormalTok{y =}\StringTok{ }\DecValTok{9}\OperatorTok{:}\DecValTok{1}
\NormalTok{X =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(x, }\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{Y =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(y, }\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{X}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    9    6    3
## [2,]    8    5    2
## [3,]    7    4    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{+}\StringTok{ }\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]   10   10   10
## [2,]   10   10   10
## [3,]   10   10   10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{-}\StringTok{ }\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]   -8   -2    4
## [2,]   -6    0    6
## [3,]   -4    2    8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{*}\StringTok{ }\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    9   24   21
## [2,]   16   25   16
## [3,]   21   24    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{/}\StringTok{ }\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           [,1]      [,2]     [,3]
## [1,] 0.1111111 0.6666667 2.333333
## [2,] 0.2500000 1.0000000 4.000000
## [3,] 0.4285714 1.5000000 9.000000
\end{verbatim}

\begin{itemize}
\item
  Note that \texttt{X\ *\ Y} is \textbf{not} matrix multiplication.
\item
  It is element by element multiplication. (Same for \texttt{X\ /\ Y}).
\item
  Matrix multiplication uses \texttt{\%*\%}.
\item
  \texttt{t()} which gives the transpose of a matrix
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OperatorTok{%*%}\StringTok{ }\NormalTok{Y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]   90   54   18
## [2,]  114   69   24
## [3,]  138   84   30
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{t}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{solve()} which returns the inverse of a square matrix if it is invertible.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Z =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{-3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{-2}\NormalTok{, }\DecValTok{-3}\NormalTok{, }\DecValTok{-2}\NormalTok{, }\DecValTok{16}\NormalTok{), }\DecValTok{3}\NormalTok{, }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{Z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    9    2   -3
## [2,]    2    4   -2
## [3,]   -3   -2   16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{solve}\NormalTok{(Z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             [,1]        [,2]       [,3]
## [1,]  0.12931034 -0.05603448 0.01724138
## [2,] -0.05603448  0.29094828 0.02586207
## [3,]  0.01724138  0.02586207 0.06896552
\end{verbatim}

\begin{itemize}
\tightlist
\item
  To verify that \texttt{solve(Z)} returns the inverse, we multiply it by \texttt{Z}.

  \begin{itemize}
  \tightlist
  \item
    We would expect this to return the identity matrix.
  \item
    However we see that this is not the case due to some computational issues.
  \item
    However, \texttt{R} also has the \texttt{all.equal()} function which checks for equality, with some small tolerance which accounts for some computational issues.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{solve}\NormalTok{(Z) }\OperatorTok{%*%}\StringTok{ }\NormalTok{Z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              [,1]          [,2]         [,3]
## [1,] 1.000000e+00 -6.245005e-17 0.000000e+00
## [2,] 8.326673e-17  1.000000e+00 5.551115e-17
## [3,] 2.775558e-17  0.000000e+00 1.000000e+00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{diag}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{all.equal}\NormalTok{(}\KeywordTok{solve}\NormalTok{(Z) }\OperatorTok{%*%}\StringTok{ }\NormalTok{Z, }\KeywordTok{diag}\NormalTok{(}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] TRUE
\end{verbatim}

\hypertarget{exercise}{%
\subsubsection{Exercise}\label{exercise}}

\begin{itemize}
\tightlist
\item
  Solve the following simultanoues equations using matrix calculation
  \[
  2x_1+3x_2   =10 \\
  5x_1+x_2    =20
  \]
\item
  Hint: You can write this as \(Ax=y\) where A is the 2-times-2 matrix, x and y are vectors with the length of 2.
\end{itemize}

\hypertarget{getting-information-for-matrix}{%
\subsection{Getting information for matrix}\label{getting-information-for-matrix}}

\begin{itemize}
\tightlist
\item
  \texttt{R} has a number of matrix specific functions for obtaining dimension and summary information.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\NormalTok{X}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dim}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rowSums}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  9 12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{colSums}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  3  7 11
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rowMeans}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{colMeans}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.5 3.5 5.5
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The \texttt{diag()} function can be used in a number of ways. We can extract the diagonal of a matrix.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{diag}\NormalTok{(Z)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  9  4 16
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Or create a matrix with specified elements on the diagonal. (And \texttt{0} on the off-diagonals.)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{diag}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    2    0    0    0
## [3,]    0    0    3    0    0
## [4,]    0    0    0    4    0
## [5,]    0    0    0    0    5
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Or, lastly, create a square matrix of a certain dimension with \texttt{1} for every element of the diagonal and \texttt{0} for the off-diagonals.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{diag}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1
\end{verbatim}

\hypertarget{lists}{%
\section{Lists}\label{lists}}

\begin{itemize}
\tightlist
\item
  A list is a one-dimensional heterogeneous data structure.

  \begin{itemize}
  \tightlist
  \item
    It is indexed like a vector with a single integer value,
  \item
    but each element can contain an element of any type.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# creation}
\KeywordTok{list}\NormalTok{(}\DecValTok{42}\NormalTok{, }\StringTok{"Hello"}\NormalTok{, }\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## [1] 42
## 
## [[2]]
## [1] "Hello"
## 
## [[3]]
## [1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list =}\StringTok{ }\KeywordTok{list}\NormalTok{(}
  \DataTypeTok{a =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{),}
  \DataTypeTok{b =} \OtherTok{TRUE}\NormalTok{,}
  \DataTypeTok{c =} \StringTok{"Hello!"}\NormalTok{,}
  \DataTypeTok{d =} \ControlFlowTok{function}\NormalTok{(}\DataTypeTok{arg =} \DecValTok{42}\NormalTok{) \{}\KeywordTok{print}\NormalTok{(}\StringTok{"Hello World!"}\NormalTok{)\},}
  \DataTypeTok{e =} \KeywordTok{diag}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Lists can be subset using two syntaxes,

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    the \texttt{\$} operator, and
  \item
    square brackets \texttt{{[}{]}}.
  \end{enumerate}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# subsetting}
\NormalTok{ex_list}\OperatorTok{$}\NormalTok{e}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list[}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $a
## [1] 1 2 3 4
## 
## $b
## [1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $a
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list[}\KeywordTok{c}\NormalTok{(}\StringTok{"e"}\NormalTok{, }\StringTok{"a"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $e
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1
## 
## $a
## [1] 1 2 3 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list[}\StringTok{"e"}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $e
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0    0    1    0    0
## [4,]    0    0    0    1    0
## [5,]    0    0    0    0    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ex_list}\OperatorTok{$}\NormalTok{d}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## function(arg = 42) {print("Hello World!")}
\end{verbatim}

\hypertarget{data-frames}{%
\section{Data Frames}\label{data-frames}}

\begin{itemize}
\tightlist
\item
  We will talk about Dataframe in the next chapter.
\end{itemize}

\hypertarget{programming-basics--control-flow-}{%
\section{Programming Basics -Control flow-}\label{programming-basics--control-flow-}}

\hypertarget{ifelse}{%
\subsection{if/else}\label{ifelse}}

\begin{itemize}
\tightlist
\item
  The if/else syntax is:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (...) \{}
\NormalTok{  some R code}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  more R code}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Example: To see whether x is large than y.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{1}
\NormalTok{y =}\StringTok{ }\DecValTok{3}
\ControlFlowTok{if}\NormalTok{ (x }\OperatorTok{>}\StringTok{ }\NormalTok{y) \{}
\NormalTok{  z =}\StringTok{ }\NormalTok{x }\OperatorTok{*}\StringTok{ }\NormalTok{y}
  \KeywordTok{print}\NormalTok{(}\StringTok{"x is larger than y"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{  z =}\StringTok{ }\NormalTok{x }\OperatorTok{+}\StringTok{ }\DecValTok{5} \OperatorTok{*}\StringTok{ }\NormalTok{y}
  \KeywordTok{print}\NormalTok{(}\StringTok{"x is less than or equal to y"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "x is less than or equal to y"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{R} also has a special function \texttt{ifelse()}

  \begin{itemize}
  \tightlist
  \item
    It returns one of two specified values based on a conditional statement.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ifelse}\NormalTok{(}\DecValTok{4} \OperatorTok{>}\StringTok{ }\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The real power of \texttt{ifelse()} comes from its ability to be applied to vectors.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fib =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{21}\NormalTok{)}
\KeywordTok{ifelse}\NormalTok{(fib }\OperatorTok{>}\StringTok{ }\DecValTok{6}\NormalTok{, }\StringTok{"Foo"}\NormalTok{, }\StringTok{"Bar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Bar" "Bar" "Bar" "Bar" "Bar" "Foo" "Foo" "Foo"
\end{verbatim}

\hypertarget{for-loop}{%
\section{\texorpdfstring{\texttt{for} loop}{for loop}}\label{for-loop}}

\begin{itemize}
\tightlist
\item
  A \texttt{for} loop repeats the same procedure for the specified number of times
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{11}\OperatorTok{:}\DecValTok{15}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{  x[i] =}\StringTok{ }\NormalTok{x[i] }\OperatorTok{*}\StringTok{ }\DecValTok{2}
\NormalTok{\}}

\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 22 24 26 28 30
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Note that this \texttt{for} loop is very normal in many programming languages.
\item
  In \texttt{R} we would not use a loop, instead we would simply use a vectorized operation.

  \begin{itemize}
  \tightlist
  \item
    \texttt{for} loop in \texttt{R} is known to be very slow.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x =}\StringTok{ }\DecValTok{11}\OperatorTok{:}\DecValTok{15}
\NormalTok{x =}\StringTok{ }\NormalTok{x }\OperatorTok{*}\StringTok{ }\DecValTok{2}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 22 24 26 28 30
\end{verbatim}

\hypertarget{functions}{%
\section{Functions}\label{functions}}

\begin{itemize}
\tightlist
\item
  To use a function,

  \begin{itemize}
  \tightlist
  \item
    you simply type its name,
  \item
    followed by an open parenthesis,
  \item
    then specify values of its arguments,
  \item
    then finish with a closing parenthesis.
  \end{itemize}
\item
  An \textbf{argument} is a variable which is used in the body of the function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# The following is just a demonstration, not the real function in R.}
\KeywordTok{function_name}\NormalTok{(}\DataTypeTok{arg1 =} \DecValTok{10}\NormalTok{, }\DataTypeTok{arg2 =} \DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  We can also write our own functions in \texttt{R}.
\item
  Example: ``standardize'' variables
  \[
  \frac{x - \bar{x}}{s}
  \]
\item
  When writing a function, there are three thing you must do.

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Give the function a name. Preferably something that is short, but descriptive.
  \item
    Specify the arguments using \texttt{function()}
  \item
    Write the body of the function within curly braces, \texttt{\{\}}.
  \end{enumerate}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{standardize =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  m =}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)}
\NormalTok{  std =}\StringTok{ }\KeywordTok{sd}\NormalTok{(x)}
\NormalTok{  result =}\StringTok{ }\NormalTok{(x }\OperatorTok{-}\StringTok{ }\NormalTok{m) }\OperatorTok{/}\StringTok{ }\NormalTok{std}
  \KeywordTok{return}\NormalTok{(result)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Here the name of the function is \texttt{standardize},
\item
  The function has a single argument \texttt{x} which is used in the body of function.
\item
  Note that the output of the final line of the body is what is returned by the function.
\item
  Let's test our function
\item
  Take a random sample of size \texttt{n\ =\ 10} from a normal distribution with a mean of \texttt{2} and a standard deviation of \texttt{5}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test_sample =}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{10}\NormalTok{, }\DataTypeTok{mean =} \DecValTok{2}\NormalTok{, }\DataTypeTok{sd =} \DecValTok{5}\NormalTok{)}
\NormalTok{test_sample}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  -1.152080  -1.902363   7.496638  -3.575524 -10.786826   5.679470
##  [7]   0.639967   1.931371   6.142081   7.622131
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{standardize}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ test_sample)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -0.40376996 -0.53204981  1.07494844 -0.81811925 -2.05107485
##  [6]  0.76425745 -0.09737386  0.12342460  0.84335249  1.09640474
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The same function can be written more simply.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{standardize =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  (x }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)) }\OperatorTok{/}\StringTok{ }\KeywordTok{sd}\NormalTok{(x)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  When specifying arguments, you can provide default arguments.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{power_of_num =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(num, }\DataTypeTok{power =} \DecValTok{2}\NormalTok{) \{}
\NormalTok{  num }\OperatorTok{^}\StringTok{ }\NormalTok{power}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Let's look at a number of ways that we could run this function to perform the operation \texttt{10\^{}2} resulting in \texttt{100}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DataTypeTok{num =} \DecValTok{10}\NormalTok{, }\DataTypeTok{power =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DataTypeTok{power =} \DecValTok{2}\NormalTok{, }\DataTypeTok{num =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Note that without using the argument names, the order matters. The following code will not evaluate to the same output as the previous example.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1024
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Also, the following line of code would produce an error since arguments without a default value must be specified.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{power_of_num}\NormalTok{(}\DataTypeTok{power =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  To further illustrate a function with a default argument, we will write a function that calculates sample variance two ways.
\item
  By default, the function will calculate the unbiased estimate of \(\sigma^2\), which we will call \(s^2\).
\end{itemize}

\[
s^2 = \frac{1}{n - 1}\sum_{i=1}^{n}(x - \bar{x})^2
\]

\begin{itemize}
\tightlist
\item
  It will also have the ability to return the biased estimate (based on maximum likelihood) which we will call \(\hat{\sigma}^2\).
\end{itemize}

\[
\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^{n}(x - \bar{x})^2
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{get_var =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, }\DataTypeTok{unbiased =} \OtherTok{TRUE}\NormalTok{) \{}

  \ControlFlowTok{if}\NormalTok{ (unbiased }\OperatorTok{==}\StringTok{ }\OtherTok{TRUE}\NormalTok{)\{}
\NormalTok{    n =}\StringTok{ }\KeywordTok{length}\NormalTok{(x) }\OperatorTok{-}\StringTok{ }\DecValTok{1}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (unbiased }\OperatorTok{==}\StringTok{ }\OtherTok{FALSE}\NormalTok{)\{}
\NormalTok{    n =}\StringTok{ }\KeywordTok{length}\NormalTok{(x) }
\NormalTok{   \}}

\NormalTok{  (}\DecValTok{1} \OperatorTok{/}\StringTok{ }\NormalTok{n) }\OperatorTok{*}\StringTok{ }\KeywordTok{sum}\NormalTok{((x }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)) }\OperatorTok{^}\StringTok{ }\DecValTok{2}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{get_var}\NormalTok{(test_sample)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 34.20838
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{get_var}\NormalTok{(test_sample, }\DataTypeTok{unbiased =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 34.20838
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{(test_sample)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 34.20838
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We see the function is working as expected, and when returning the unbiased estimate it matches \texttt{R}'s built in function \texttt{var()}. Finally, let's examine the biased estimate of \(\sigma^2\).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{get_var}\NormalTok{(test_sample, }\DataTypeTok{unbiased =} \OtherTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30.78754
\end{verbatim}

\hypertarget{data-frame}{%
\chapter{Data frame}\label{data-frame}}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

\begin{itemize}
\tightlist
\item
  A \textbf{data frame} is the most common way that we store and interact with data in this course.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{example_data =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{9}\NormalTok{),}
                          \DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\StringTok{"Hello"}\NormalTok{, }\DecValTok{9}\NormalTok{), }\StringTok{"Goodbye"}\NormalTok{),}
                          \DataTypeTok{z =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\OtherTok{TRUE}\NormalTok{, }\OtherTok{FALSE}\NormalTok{), }\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  A data frame is a \textbf{list} of vectors.

  \begin{itemize}
  \tightlist
  \item
    Each vector must contain the same data type
  \item
    The difference vectors can store different data types.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{example_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    x       y     z
## 1  1   Hello  TRUE
## 2  3   Hello FALSE
## 3  5   Hello  TRUE
## 4  7   Hello FALSE
## 5  9   Hello  TRUE
## 6  1   Hello FALSE
## 7  3   Hello  TRUE
## 8  5   Hello FALSE
## 9  7   Hello  TRUE
## 10 9 Goodbye FALSE
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{write.csv} save (or export) the dataframe in \texttt{.csv} format.
\end{itemize}

\hypertarget{load-csv-file}{%
\section{Load csv file}\label{load-csv-file}}

\begin{itemize}
\tightlist
\item
  We can also import data from various file types in into \texttt{R}, as well as use data stored in packages.
\item
  Read \texttt{csv} file into R.

  \begin{itemize}
  \tightlist
  \item
    \texttt{read.csv()} function as default
  \item
    \texttt{read\_csv()} function from the \texttt{readr} package. This is faster for larger data.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# install.packages("readr") }
\CommentTok{#library(readr)}
\CommentTok{#example_data_from_csv = read_csv("example-data.csv")}
\NormalTok{example_data_from_csv =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"example-data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Note: This particular line of code assumes that the file \texttt{example\_data.csv} exists in your current working directory.
\item
  The current working directory is the folder that you are working with. To see this, you type
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{getwd}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "C:/Users/Yuta/Dropbox/Teaching/2019S_Applied_Econometrics_JPN_ENG/Material_Github"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  If you want to set the working directory, use \texttt{setwd()} function
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\DataTypeTok{dir =} \StringTok{"directory path"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\hypertarget{examine-dataframe}{%
\section{Examine dataframe}\label{examine-dataframe}}

\begin{itemize}
\tightlist
\item
  Inside the \texttt{ggplot2} package is a dataset called \texttt{mpg}. By loading the package using the \texttt{library()} function, we can now access \texttt{mpg}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Three things we would generally like to do with data:

  \begin{itemize}
  \tightlist
  \item
    Look at the raw data.
  \item
    Understand the data. (Where did it come from? What are the variables? Etc.)
  \item
    Visualize the data.
  \end{itemize}
\item
  To look at the data, we have two useful commands: \texttt{head()} and \texttt{str()}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(mpg, }\DataTypeTok{n =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 11
##    manufacturer model displ  year   cyl trans drv     cty   hwy fl    class
##    <chr>        <chr> <dbl> <int> <int> <chr> <chr> <int> <int> <chr> <chr>
##  1 audi         a4      1.8  1999     4 auto~ f        18    29 p     comp~
##  2 audi         a4      1.8  1999     4 manu~ f        21    29 p     comp~
##  3 audi         a4      2    2008     4 manu~ f        20    31 p     comp~
##  4 audi         a4      2    2008     4 auto~ f        21    30 p     comp~
##  5 audi         a4      2.8  1999     6 auto~ f        16    26 p     comp~
##  6 audi         a4      2.8  1999     6 manu~ f        18    26 p     comp~
##  7 audi         a4      3.1  2008     6 auto~ f        18    27 p     comp~
##  8 audi         a4 q~   1.8  1999     4 manu~ 4        18    26 p     comp~
##  9 audi         a4 q~   1.8  1999     4 auto~ 4        16    25 p     comp~
## 10 audi         a4 q~   2    2008     4 manu~ 4        20    28 p     comp~
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The function \texttt{str()} will display the ``structure'' of the data frame.

  \begin{itemize}
  \tightlist
  \item
    It will display the number of \textbf{observations} and \textbf{variables}, list the variables, give the type of each variable, and show some elements of each variable.
  \item
    This information can also be found in the ``Environment'' window in RStudio.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(mpg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Classes 'tbl_df', 'tbl' and 'data.frame':    234 obs. of  11 variables:
##  $ manufacturer: chr  "audi" "audi" "audi" "audi" ...
##  $ model       : chr  "a4" "a4" "a4" "a4" ...
##  $ displ       : num  1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
##  $ year        : int  1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
##  $ cyl         : int  4 4 4 4 6 6 6 4 4 4 ...
##  $ trans       : chr  "auto(l5)" "manual(m5)" "manual(m6)" "auto(av)" ...
##  $ drv         : chr  "f" "f" "f" "f" ...
##  $ cty         : int  18 21 20 21 16 18 18 18 16 20 ...
##  $ hwy         : int  29 29 31 30 26 26 27 26 25 28 ...
##  $ fl          : chr  "p" "p" "p" "p" ...
##  $ class       : chr  "compact" "compact" "compact" "compact" ...
\end{verbatim}

\begin{itemize}
\tightlist
\item
  \texttt{names()} function to obtain names of the variables in the dataset
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{names}\NormalTok{(mpg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "manufacturer" "model"        "displ"        "year"        
##  [5] "cyl"          "trans"        "drv"          "cty"         
##  [9] "hwy"          "fl"           "class"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  To access one of the variables \textbf{as a vector}, we use the \texttt{\$} operator.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mpg}\OperatorTok{$}\NormalTok{year}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008
##  [15] 2008 1999 2008 2008 2008 2008 2008 1999 2008 1999 1999 2008 2008 2008
##  [29] 2008 2008 1999 1999 1999 2008 1999 2008 2008 1999 1999 1999 1999 2008
##  [43] 2008 2008 1999 1999 2008 2008 2008 2008 1999 1999 2008 2008 2008 1999
##  [57] 1999 1999 2008 2008 2008 1999 2008 1999 2008 2008 2008 2008 2008 2008
##  [71] 1999 1999 2008 1999 1999 1999 2008 1999 1999 1999 2008 2008 1999 1999
##  [85] 1999 1999 1999 2008 1999 2008 1999 1999 2008 2008 1999 1999 2008 2008
##  [99] 2008 1999 1999 1999 1999 1999 2008 2008 2008 2008 1999 1999 2008 2008
## [113] 1999 1999 2008 1999 1999 2008 2008 2008 2008 2008 2008 2008 1999 1999
## [127] 2008 2008 2008 2008 1999 2008 2008 1999 1999 1999 2008 1999 2008 2008
## [141] 1999 1999 1999 2008 2008 2008 2008 1999 1999 2008 1999 1999 2008 2008
## [155] 1999 1999 1999 2008 2008 1999 1999 2008 2008 2008 2008 1999 1999 1999
## [169] 1999 2008 2008 2008 2008 1999 1999 1999 1999 2008 2008 1999 1999 2008
## [183] 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008 1999 1999 1999
## [197] 2008 2008 1999 2008 1999 1999 2008 1999 1999 2008 2008 1999 1999 2008
## [211] 2008 1999 1999 1999 1999 2008 2008 2008 2008 1999 1999 1999 1999 1999
## [225] 1999 2008 2008 1999 1999 2008 2008 1999 1999 2008
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mpg}\OperatorTok{$}\NormalTok{hwy}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 29 29 31 30 26 26 27 26 25 28 27 25 25 25 25 24 25 23 20 15 20 17 17
##  [24] 26 23 26 25 24 19 14 15 17 27 30 26 29 26 24 24 22 22 24 24 17 22 21
##  [47] 23 23 19 18 17 17 19 19 12 17 15 17 17 12 17 16 18 15 16 12 17 17 16
##  [70] 12 15 16 17 15 17 17 18 17 19 17 19 19 17 17 17 16 16 17 15 17 26 25
##  [93] 26 24 21 22 23 22 20 33 32 32 29 32 34 36 36 29 26 27 30 31 26 26 28
## [116] 26 29 28 27 24 24 24 22 19 20 17 12 19 18 14 15 18 18 15 17 16 18 17
## [139] 19 19 17 29 27 31 32 27 26 26 25 25 17 17 20 18 26 26 27 28 25 25 24
## [162] 27 25 26 23 26 26 26 26 25 27 25 27 20 20 19 17 20 17 29 27 31 31 26
## [185] 26 28 27 29 31 31 26 26 27 30 33 35 37 35 15 18 20 20 22 17 19 18 20
## [208] 29 26 29 29 24 44 29 26 29 29 29 29 23 24 44 41 29 26 28 29 29 29 28
## [231] 29 26 26 26
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We can use the \texttt{dim()}, \texttt{nrow()} and \texttt{ncol()} functions to obtain information about the dimension of the data frame.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dim}\NormalTok{(mpg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 234  11
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{nrow}\NormalTok{(mpg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 234
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ncol}\NormalTok{(mpg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 11
\end{verbatim}

\hypertarget{subsetting-data}{%
\section{Subsetting data}\label{subsetting-data}}

\begin{itemize}
\tightlist
\item
  Subsetting data frames can work much like subsetting matrices using square brackets, \texttt{{[},{]}}.
\item
  Here, we find fuel efficient vehicles earning over 35 miles per gallon and only display \texttt{manufacturer}, \texttt{model} and \texttt{year}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mpg[mpg}\OperatorTok{$}\NormalTok{hwy }\OperatorTok{>}\StringTok{ }\DecValTok{35}\NormalTok{, }\KeywordTok{c}\NormalTok{(}\StringTok{"manufacturer"}\NormalTok{, }\StringTok{"model"}\NormalTok{, }\StringTok{"year"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 3
##   manufacturer model       year
##   <chr>        <chr>      <int>
## 1 honda        civic       2008
## 2 honda        civic       2008
## 3 toyota       corolla     2008
## 4 volkswagen   jetta       1999
## 5 volkswagen   new beetle  1999
## 6 volkswagen   new beetle  1999
\end{verbatim}

\begin{itemize}
\tightlist
\item
  An alternative would be to use the \texttt{subset()} function, which has a much more readable syntax.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{subset}\NormalTok{(mpg, }\DataTypeTok{subset =}\NormalTok{ hwy }\OperatorTok{>}\StringTok{ }\DecValTok{35}\NormalTok{, }\DataTypeTok{select =} \KeywordTok{c}\NormalTok{(}\StringTok{"manufacturer"}\NormalTok{, }\StringTok{"model"}\NormalTok{, }\StringTok{"year"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Lastly, we could use the \texttt{filter} and \texttt{select} functions from the \texttt{dplyr} package which introduces the \texttt{\%\textgreater{}\%} operator from the \texttt{magrittr} package.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\NormalTok{mpg }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{filter}\NormalTok{(hwy }\OperatorTok{>}\StringTok{ }\DecValTok{35}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }
\KeywordTok{select}\NormalTok{(manufacturer, model, year)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  I will give you an assignment about \texttt{dplyr} package in the \texttt{DataCamp} as a makeup lecture.
\end{itemize}

\hypertarget{exercise-1}{%
\chapter{Exercise 1}\label{exercise-1}}

\begin{itemize}
\tightlist
\item
  Due date: April 22th (Monday) 11pm
\end{itemize}

\textbf{Rules for Problem Sets}

\begin{itemize}
\tightlist
\item
  If you are enrolled in Japanese class (i.e., Wednesday 2nd), you can use both Japanese and English to write your answer.
\item
  Submit your solution through \texttt{CourseN@vi}.
\item
  Submit both your answer and R script.
\item
  Using \texttt{Rmarkdown} would be appreciated, though not mandatory.

  \begin{itemize}
  \tightlist
  \item
    \texttt{Rmarkdown} introduction in Japanese: \url{https://kazutan.github.io/kazutanR/Rmd_intro.html}
  \item
    \texttt{Rmarkdown} introduction in English: \url{https://rmarkdown.rstudio.com/articles_intro.html}
  \end{itemize}
\item
  I might cover \texttt{Rmarkdown} in the course later.
\end{itemize}

\hypertarget{update-as-of-10am-april-18th}{%
\section{Update (as of 10am, April 18th)}\label{update-as-of-10am-april-18th}}

\begin{itemize}
\tightlist
\item
  Please calculate the standard deviation, not the variance in your simulation. The parameter you set when drawing the random number is the mean \(\mu\) and the standard deviation \(\sigma\) in normal distribution.
\item
  Use \texttt{seq} function to create the sequence of the sample sizes that you use in the simulation.
\end{itemize}

\hypertarget{question-examine-the-law-of-large-numbers-through-numerical-simulations}{%
\section{Question: Examine the law of large numbers through numerical simulations}\label{question-examine-the-law-of-large-numbers-through-numerical-simulations}}

Consider the random sample of \(\{x_{i}\}_{i=1}^{N}\) drawn from the random variable \(X\). The law of large numbers implies that

\[
\frac{1}{N}\sum_{i=1}^{N}x_{i}\overset{p}{\longrightarrow}E[X]
\]

In other words, the sample mean converges to the population mean in probability as the sample size goes to infinity (i.e., \(N \rightarrow \infty\)).

Similary, the sample variance also converges to the population variance in probability

\[
\frac{1}{N}\sum_{i=1}^{N}(x_{i}-\bar{x})^{2}\overset{p}{\longrightarrow}V[X]
\]

\textbf{(Note on 4/18) This implies that the sample standard deviation also converges to the population standard deviation}

(This is an application of the law of large numbers, though it is a bit involved to prove this.)

The goal of this problem set is to demonstrate these two properties through numerical simulations.
Here is what we are going to do:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For a certain sample size \(N\), draw \(N\) random numbers from the normal distribution with known mean and standard deviation.
\item
  Calculate the sample mean and the sample variance for the ``data'' you draw.
\item
  Repeat this for many different sample sizes.
\item
  Examine to see whether the sample mean and \textbf{standard deviation} are getting closer to the true value, which you set when you draw the random numbers, as the sample size gets larger.
\end{enumerate}

\hypertarget{how-to-implement}{%
\subsection{How to implement}\label{how-to-implement}}

I explain how to implement this in \texttt{R} step by step below.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Prepare a function like this

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    There are two inputs: (1) a vector that contains the data \(\{x_{i}\}_{i=1}^{N}\) and (2) the indicator of whether you calculate the mean or the standard deviation.
  \end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fun_something =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(firstinput, secondinput)\{}

  \CommentTok{# Two inputs: firstinput, secondinput}
  \CommentTok{# One output: output}

  \CommentTok{# Do something.}

  \KeywordTok{return}\NormalTok{(output)}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \setcounter{enumii}{1}
  \tightlist
  \item
    Use if/else sentence. Example:
  \end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# "secondinput" is the name of the input variable in your function}
\ControlFlowTok{if}\NormalTok{ ( secondinput }\OperatorTok{==}\StringTok{ "mean"}\NormalTok{)\{}
  \CommentTok{# calculate mean of the data (firstinput)}

\NormalTok{\} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ ( secondinput }\OperatorTok{==}\StringTok{ "sd"}\NormalTok{)\{}
  \CommentTok{# Calculate standard deviation of the data (firstinput) }
\NormalTok{\}    }
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \setcounter{enumii}{2}
  \tightlist
  \item
    Use \texttt{return} function to define the output of the function.
  \end{enumerate}
\item
  Construct a vector that contains the sample size you want to use in your simulation. For example:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{samplesize_vec =}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DataTypeTok{from =} \DecValTok{100}\NormalTok{, }\DataTypeTok{to =} \DecValTok{100000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Here, let's try 100 different sample sizes that ranges from 100 to 100000.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Prepare two vectors that contain the result in the \texttt{forloop} below. Since we are trying 100 different sample sizes, let's create a vector with the length of 100.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Hint:}
\CommentTok{# numeric(k) returns a zero vector with the length of k }
\CommentTok{# length( vector) returns the length of `vector`}

\CommentTok{# result_mean = .... }
\CommentTok{# result_sd = ....}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  To create the random draw from the normal distribution, use below
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# You can choose the mean and the standard deviation as you like.}
\KeywordTok{rnorm}\NormalTok{(}\DataTypeTok{n =} \DecValTok{100}\NormalTok{, }\DataTypeTok{mean =} \DecValTok{2}\NormalTok{, }\DataTypeTok{sd =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Use \texttt{forloop} to calculate both mean and the standard deviation for each sample size. For example:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(samplesize_vec))\{}
  
  \CommentTok{# Draw the random number}
  
  \CommentTok{# Calculate the mean using the function you construct. }
  
  \CommentTok{# Calculate the standard deviation using the function you construct.}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Plot the result with \texttt{ggplot2}.

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Install the package if you have not done it yet.
  \item
    Load \texttt{ggplot2} by \texttt{library(ggplot2)}
  \item
    Use \texttt{qplot} command to make a figure
  \end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create plot and save it as the variable `plot1`}
\NormalTok{plot1 <-}\StringTok{ }\KeywordTok{qplot}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ samplesize_vec, }\DataTypeTok{y =}\NormalTok{ yourresult, }\DataTypeTok{geom =} \StringTok{"line"}\NormalTok{)}

\CommentTok{# print "plot1"}
\KeywordTok{print}\NormalTok{(plot1)}

\CommentTok{# save the plot as PNG file}
\KeywordTok{ggsave}\NormalTok{(}\DataTypeTok{file =} \StringTok{"filename.png"}\NormalTok{, }\DataTypeTok{plot =}\NormalTok{ plot1)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\hypertarget{what-to-submit}{%
\subsection{What to submit}\label{what-to-submit}}

Your answer should include

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The true value of mean and variance you choose in your simulation.
\item
  The plot that describes the relationship between the sample mean (variance) and the sample size.
\item
  Explain what the plots from your simulation indicate.
\end{enumerate}

\hypertarget{a-review-of-statistics}{%
\chapter{A Review of Statistics}\label{a-review-of-statistics}}

\textbf{Acknowledgement:} This chapter is largely based on chapter 3 of ``Introduction to Econometrics with R''. \url{https://www.econometrics-with-r.org/index.html}

The goal of this chapter is

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Review of important concepts in statistics

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Estimation
  \item
    Hypothesis testing
  \end{enumerate}
\item
  Review of tools from probability theory

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Law of large numbers
  \item
    Central limit theorem
  \end{enumerate}
\end{enumerate}

\hypertarget{estimation}{%
\section{Estimation}\label{estimation}}

\begin{itemize}
\tightlist
\item
  Estimator: A mapping from the sample data drawn from an unknown population to a certain feature in the population
\item
  Example: Consider hourly earnings of college graduates \(Y\) .
\item
  You want to estimate the mean of \(Y\), defined as \(E[Y] = \mu_y\)
\item
  Draw a random sample of \(n\) i.i.d. (identically and independently distributed) observations \({ Y_1, Y_2, \ldots, Y_N }\)
\item
  How to estimate \(E[Y]\) from the data?
\item
  Idea 1: Sample mean
  \[ 
  \bar{Y} = \frac{1}{n} \sum_{i=1}^n Y_i, 
  \]
\item
  Idea 2: Pick the first observation of the sample.
\item
  Question: How can we say which is better?
\end{itemize}

\hypertarget{properties-of-the-estimator}{%
\subsection{Properties of the estimator}\label{properties-of-the-estimator}}

Consider the estimator \(\hat{\mu}_N\) for the unknown parameter \(\mu\).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Unbiasdeness: The expectation of the estimator is the same as the true parameter in the population.
  \[
    E[\hat{\mu}_N] = \mu
  \]
\item
  Consistency: The estimator converges to the true parameter in probability.
  \[
  \forall \epsilon >0, \lim_{N \rightarrow \infty} \ Prob(|\hat{\mu}_{N}-\mu|<\epsilon)=1
  \]

  \begin{itemize}
  \tightlist
  \item
    Intuition: As the sample size gets larger, the estimator and the true parameter is close with probability one.
  \item
    Note: a bit different from the usual convergence of the sequence.
  \end{itemize}
\end{enumerate}

\hypertarget{sample-mean-bary-is-unbiased-and-consistent}{%
\subsection{\texorpdfstring{Sample mean \(\bar{Y}\) is unbiased and consistent}{Sample mean \textbackslash{}bar\{Y\} is unbiased and consistent}}\label{sample-mean-bary-is-unbiased-and-consistent}}

\begin{itemize}
\item
  Showing these two properties using mathmaetics is straightforward:

  \begin{itemize}
  \tightlist
  \item
    Unbiasedness: Take expectation.
  \item
    Consistency: Law of large numbers.
  \end{itemize}
\item
  Let's examine these two properties using R.
\item
  Step 1: Prepare a population. Here, I prepare income and age data from PUMS 5\% sample of U.S. Census 2000.

  \begin{itemize}
  \tightlist
  \item
    PUMS: Public Use Microdata Sample
  \item
    \href{data_pums_2000.csv}{Download the example data here as a .csv file.} Put this file in the same folder as your R script file.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use "readr" package}
\KeywordTok{library}\NormalTok{(readr)}
\NormalTok{pums2000 <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(}\StringTok{"data_pums_2000.csv"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Parsed with column specification:
## cols(
##   AGE = col_double(),
##   INCTOT = col_double()
## )
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We treat this dataset as \textbf{population}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop <-}\StringTok{ }\KeywordTok{as.vector}\NormalTok{(pums2000}\OperatorTok{$}\NormalTok{INCTOT)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \emph{Population} mean and standard deviation
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pop_mean =}\StringTok{ }\KeywordTok{mean}\NormalTok{(pop)}
\NormalTok{pop_sd   =}\StringTok{ }\KeywordTok{sd}\NormalTok{(pop)}

\CommentTok{# Average income in population}
\NormalTok{pop_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30165.47
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Standard deviation of income in population}
\NormalTok{pop_sd}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 38306.17
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# income distribution in population}
\CommentTok{# Note that the unit is in USD.}
\KeywordTok{library}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{)}
\KeywordTok{qplot}\NormalTok{(pop, }\DataTypeTok{geom =} \StringTok{"density"}\NormalTok{, }
      \DataTypeTok{xlab =} \StringTok{"Income"}\NormalTok{,}
      \DataTypeTok{ylab =} \StringTok{"Density"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Econometrics_using_R_files/figure-latex/unnamed-chunk-107-1.pdf}

\begin{itemize}
\tightlist
\item
  The distribution has a long tail.
\item
  Let's plot the distribution in \emph{log} scale
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# `log` option specifies which axis is represented in log scale.}
\KeywordTok{qplot}\NormalTok{(pop, }\DataTypeTok{geom =} \StringTok{"density"}\NormalTok{, }
      \DataTypeTok{xlab =} \StringTok{"Income"}\NormalTok{,}
      \DataTypeTok{ylab =} \StringTok{"Density"}\NormalTok{,}
      \DataTypeTok{log =} \StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Econometrics_using_R_files/figure-latex/unnamed-chunk-108-1.pdf}

\begin{itemize}
\tightlist
\item
  Let's investigate how close the sample mean constucted from the random sample is to the true population mean.
\item
  Step 1: Draw random sample\emph{s} from this population and calculate \(\bar{Y}\) for each sample.

  \begin{itemize}
  \tightlist
  \item
    Set the sample size \(N\).
  \end{itemize}
\item
  Step 2: Repeat 2000 times. You now have 2000 sample means.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Set the seed for the random number. This is needed to maintaine the reproducibility of the results.}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{# draw random sample of 100 observations from the variable pop}
\NormalTok{test <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =} \DecValTok{100}\NormalTok{)}

\CommentTok{# Use loop to repeat 2000 times. }
\NormalTok{Nsamples =}\StringTok{ }\DecValTok{2000}
\NormalTok{result1 <-}\StringTok{ }\KeywordTok{numeric}\NormalTok{(Nsamples)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{Nsamples )\{}
  
\NormalTok{  test <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =} \DecValTok{100}\NormalTok{)}
\NormalTok{  result1[i] <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(test)}
  
\NormalTok{\}}

\CommentTok{# Simple approach}
\NormalTok{result1 <-}\StringTok{ }\KeywordTok{replicate}\NormalTok{(}\DataTypeTok{expr =} \KeywordTok{mean}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =} \DecValTok{10}\NormalTok{)), }\DataTypeTok{n =}\NormalTok{ Nsamples)}
\NormalTok{result2 <-}\StringTok{ }\KeywordTok{replicate}\NormalTok{(}\DataTypeTok{expr =} \KeywordTok{mean}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =} \DecValTok{100}\NormalTok{)), }\DataTypeTok{n =}\NormalTok{ Nsamples)}
\NormalTok{result3 <-}\StringTok{ }\KeywordTok{replicate}\NormalTok{(}\DataTypeTok{expr =} \KeywordTok{mean}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =} \DecValTok{500}\NormalTok{)), }\DataTypeTok{n =}\NormalTok{ Nsamples)}

\CommentTok{# Create dataframe}

\NormalTok{result_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(  }\DataTypeTok{Ybar10 =}\NormalTok{ result1, }
                            \DataTypeTok{Ybar100 =}\NormalTok{ result2, }
                            \DataTypeTok{Ybar500 =}\NormalTok{ result3)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Step 3: See the distribution of those 2000 sample means.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use reshape library}
\CommentTok{# install.packages("reshape")}
\KeywordTok{library}\NormalTok{(}\StringTok{"reshape"}\NormalTok{)}

\CommentTok{# Use "melt" to change the format of result_data}
\NormalTok{data_for_plot <-}\StringTok{ }\KeywordTok{melt}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ result_data, }\DataTypeTok{variable.name =} \StringTok{"Variable"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Using  as id variables
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use "ggplot2" to create the figure.}
\CommentTok{# The variable `fig` contains the information about the figure}
\NormalTok{fig <-}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ data_for_plot) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Sample mean"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ value, }\DataTypeTok{colour =}\NormalTok{ variable ),   }\DataTypeTok{stat =} \StringTok{"density"}\NormalTok{ ) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_vline}\NormalTok{(}\DataTypeTok{xintercept=}\NormalTok{pop_mean ,}\DataTypeTok{colour=}\StringTok{"black"}\NormalTok{)}

\CommentTok{# Display the figure }
\KeywordTok{plot}\NormalTok{(fig)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Econometrics_using_R_files/figure-latex/unnamed-chunk-110-1.pdf}

\begin{itemize}
\tightlist
\item
  Observation 1: Regardless of the sample size, the average of the sample means is close to the population mean. \textbf{Unbiasdeness}
\item
  Observation 2: As the sample size gets larger, the distribution is concentrated around the population mean. \textbf{Consistency (law of large numbers)}
\end{itemize}

\hypertarget{hypothesis-testing}{%
\section{Hypothesis Testing}\label{hypothesis-testing}}

\hypertarget{central-limit-theorem}{%
\subsection{Central limit theorem}\label{central-limit-theorem}}

\begin{itemize}
\item
  Cental limit theorem: Consider the i.i.d. sample of \(Y_1,\cdots, Y_N\) drawn from the random variable \(Y\) with mean \(\mu\) and variance \(\sigma^2\). The following \(Z\) converges in distribution to the normal distribution.
  \[
  Z = \frac{1}{\sqrt{N}} \sum_{i=1}^N \frac{Y_i - \mu}{\sigma } \overset{d}{\rightarrow}N(0,1)
  \]
  In other words,
  \[
  \lim_{N\rightarrow\infty}P\left(Z \leq z\right)=\Phi(z)
  \]
\item
  The central limit theorem implies that if \(N\) is large \textbf{enough}, we can \textbf{approximate} the distribution of \(\bar{Y}\) by the standard normal distribution with mean \(\mu\) and variance \(\sigma^2 / N\) \textbf{regardless of the underlying distribution of \(Y\).}
\item
  Let's examine this property through simulation!!
\item
  Use the same example as before. Remember that the underlying income distribution is clearly NOT normal.

  \begin{itemize}
  \tightlist
  \item
    Population mean \(\mu = 3.0165467\times 10^{4}\) and standard deviation \(\sigma = 3.8306171\times 10^{4}\). Use these numbers.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Set the seed for the random number}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{124}\NormalTok{)}

\CommentTok{# define function for simulation }
\NormalTok{f_simu_CLT =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(Nsamples, samplesize, pop, pop_mean, pop_sd )\{}
  
\NormalTok{  output =}\StringTok{ }\KeywordTok{numeric}\NormalTok{(Nsamples)}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{Nsamples )\{}
\NormalTok{    test <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ pop, }\DataTypeTok{size =}\NormalTok{ samplesize)}
\NormalTok{    output[i] <-}\StringTok{ }\NormalTok{( }\KeywordTok{mean}\NormalTok{(test) }\OperatorTok{-}\StringTok{ }\NormalTok{pop_mean ) }\OperatorTok{/}\StringTok{ }\NormalTok{(pop_sd }\OperatorTok{/}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(samplesize))}
\NormalTok{  \}}
  
  \KeywordTok{return}\NormalTok{(output)}

\NormalTok{\}}

\CommentTok{# Comment: You can do better without using forloop. Let me know if you come with a good idea.}

\CommentTok{# Run simulation }
\NormalTok{Nsamples =}\StringTok{ }\DecValTok{2000}
\NormalTok{result_CLT1 <-}\StringTok{ }\KeywordTok{f_simu_CLT}\NormalTok{(Nsamples, }\DecValTok{10}\NormalTok{, pop, pop_mean, pop_sd )}
\NormalTok{result_CLT2 <-}\StringTok{ }\KeywordTok{f_simu_CLT}\NormalTok{(Nsamples, }\DecValTok{100}\NormalTok{, pop, pop_mean, pop_sd )}
\NormalTok{result_CLT3 <-}\StringTok{ }\KeywordTok{f_simu_CLT}\NormalTok{(Nsamples, }\DecValTok{1000}\NormalTok{, pop, pop_mean, pop_sd )}

\CommentTok{# Random draw from standard normal distribution as comparison}
\NormalTok{result_stdnorm =}\StringTok{ }\KeywordTok{rnorm}\NormalTok{(Nsamples)}

\CommentTok{# Create dataframe}
\NormalTok{result_CLT_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(  }\DataTypeTok{Ybar_standardized_10 =}\NormalTok{ result_CLT1, }
                            \DataTypeTok{Ybar_standardized_100 =}\NormalTok{ result_CLT2, }
                            \DataTypeTok{Ybar_standardized_1000 =}\NormalTok{ result_CLT3, }
                            \DataTypeTok{Standard_Normal =}\NormalTok{ result_stdnorm)}

\CommentTok{# Note: If you wanna quicky plot the density, type `plot(density(result1))`. }
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Now take a look at the distribution.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use "melt" to change the format of result_data}
\NormalTok{data_for_plot <-}\StringTok{ }\KeywordTok{melt}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ result_CLT_data, }\DataTypeTok{variable.name =} \StringTok{"Variable"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Using  as id variables
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Use "ggplot2" to create the figure.}
\NormalTok{fig <-}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ data_for_plot) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Sample mean"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ value, }\DataTypeTok{colour =}\NormalTok{ variable ),   }\DataTypeTok{stat =} \StringTok{"density"}\NormalTok{ ) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_vline}\NormalTok{(}\DataTypeTok{xintercept=}\DecValTok{0}\NormalTok{ ,}\DataTypeTok{colour=}\StringTok{"black"}\NormalTok{)}

\KeywordTok{plot}\NormalTok{(fig)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Econometrics_using_R_files/figure-latex/unnamed-chunk-112-1.pdf}

\begin{itemize}
\tightlist
\item
  As the sample size grows, the distribution of \(Z\) converges to the standard normal distribution.
\end{itemize}

\hypertarget{hypothesis-testing-1}{%
\subsection{Hypothesis testing}\label{hypothesis-testing-1}}

To be added.

\hypertarget{linear-regression-1-theory}{%
\chapter{Linear Regression 1: Theory}\label{linear-regression-1-theory}}

\hypertarget{regression-framework}{%
\section{Regression framework}\label{regression-framework}}

\begin{itemize}
\tightlist
\item
  Let \(Y_i\) be the dependent variable and \(X_{ik}\) be k-th explanatory variable.

  \begin{itemize}
  \tightlist
  \item
    We have \(K\) explantory variables (along with constant term)
  \item
    \(i\) is an index for observations. \(i = 1,\cdots, N\).
  \item
    Data (sample): \(\{ Y_i , X_{i1}, \ldots, X_{iK} \}_{i=1}^N\)
  \end{itemize}
\item
  \textbf{Linear regression model} is defined as
  \[ Y_{i}=\beta_{0}+\beta_{1}X_{1i}+\cdots+\beta_{K}X_{Ki}+\epsilon_{i} \]

  \begin{itemize}
  \tightlist
  \item
    \(\epsilon_i\): error term (unobserved)
  \item
    \(\beta\): coefficients
  \end{itemize}
\item
  \textbf{Assumptions for Ordinaly Least Squares (OLS) estimation}

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Random sample: \(\{ Y_i , X_{i1}, \ldots, X_{iK} \}\) is i.i.d. drawn sample

    \begin{itemize}
    \tightlist
    \item
      i.i.d.: identically and independently distributed
    \end{itemize}
  \item
    \(\epsilon_i\) has zero conditional mean
    \[
        E[ \epsilon_i | X_{i1}, \ldots, X_{iK}] = 0
        \]
  \item
    Large outliers are unlikely: The random variable \(Y_i\) and \(X_{ik}\) have finite fourth moments.
  \item
    No perfect multicollinearity: There is no linear relationship betwen explanatory variables.
  \end{enumerate}
\item
  OLS estimators are the minimizers of the sum of squared residuals:
  \[
   \min_{\beta_0, \cdots, \beta_K} \frac{1}{N} \sum_{i=1}^N (Y_i - (\beta_0 + \beta_1 X_{i1} + \cdots + \beta_K X_{iK}))^2
   \]
\item
  Using matrix notation, we have the following analytical formula for the OLS estimator
  \[
    \hat{\beta} = (X'X)^{-1} X'Y
    \]
  where
  \[
  \underbrace{X}_{N\times (K+1)}=\left(\begin{array}{cccc}
  1 & X_{11} & \cdots & X_{1K}\\
  \vdots & \vdots &  & \vdots\\
  1 & X_{N1} & \cdots & X_{NK}
  \end{array}\right),\underbrace{Y}_{N\times 1}=\left(\begin{array}{c}
  Y_{1}\\
  \vdots\\
  Y_{N}
  \end{array}\right),\underbrace{\beta}_{(K+1)\times 1}=\left(\begin{array}{c}
  \beta_{0}\\
  \beta_{1}\\
  \vdots\\
  \beta_{K}
  \end{array}\right)            
  \]
\end{itemize}

\hypertarget{theoretical-properties-of-ols-estimator}{%
\section{Theoretical Properties of OLS estimator}\label{theoretical-properties-of-ols-estimator}}

\begin{itemize}
\tightlist
\item
  We briefly review theoretical properties of OLS estimator.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Unbiasdness}: Conditional on the explantory variables \(X\), the expectation of the OLS estimator \(\hat{\beta}\) is equal to the true value \(\beta\).
  \[
   E[\hat{\beta} | X] = \beta
   \]
\item
  \textbf{Consistency}: As the sample size \(N\) goes to infinity, the OLS estimator \(\hat{\beta}\) converges to \(\beta\) in probability
  \[
   \hat{\beta}\overset{p}{\longrightarrow}\beta
   \]
\item
  \textbf{Asymptotic normality}: Will talk this \protect\hyperlink{Statistical-Inference}{later}
\end{enumerate}

\hypertarget{interpretation-and-specifications-of-linear-regression-model}{%
\section{Interpretation and Specifications of Linear Regression Model}\label{interpretation-and-specifications-of-linear-regression-model}}

\begin{itemize}
\tightlist
\item
  Remember that
  \[ 
    Y_{i}=\beta_{0}+\beta_{1}X_{1i}+\cdots+\beta_{K}X_{Ki}+\epsilon_{i} 
    \]
\item
  The coefficient \(\beta_k\) captures the effect of \(X_k\) on \(Y\) \textbf{ceteris paribus (all things being equal)}
\item
  Equivalently,
  \[
    \frac{\partial Y}{\partial X_k} = \beta_k 
        \]
  if \(X_k\) is continuous random variable.
\item
  If we can estimate \(\beta_k\) without bias, we can obtain \textbf{causal effect} of \(X_k\) on \(Y\).

  \begin{itemize}
  \tightlist
  \item
    This is of course very difficult task. We will see this more later.
  \end{itemize}
\item
  We will see several specifications that are frequently used in empirical analysis.
  1. Nonlinear term
  1. log specification
  2. dummy (categorical) variables
  3. interaction terms
\end{itemize}

\hypertarget{nonlinear-term}{%
\subsection{Nonlinear term}\label{nonlinear-term}}

\begin{itemize}
\tightlist
\item
  We can capture non-linear relationship between \(Y\) and \(X\) in a linearly additive form
  \[
    Y_i = \beta_0 + \beta_1 X_i + \beta_2 X_i^2 + \beta_3 X_i^3 + \epsilon_i
    \]
\item
  As long as the error term \(\epsilon_i\) appreas in a additively linear way, we can estimate the coefficients by OLS.

  \begin{itemize}
  \tightlist
  \item
    Multicollinarity could be an issue if we have many polynomials (see later).
  \item
    You can use other non-linear variables such as \(log(x)\) and \(\sqrt{x}\).
  \end{itemize}
\end{itemize}

\hypertarget{log-specification}{%
\subsection{log specification}\label{log-specification}}

\begin{itemize}
\tightlist
\item
  We often use \texttt{log} variables in both dependent and independent variables.
\item
  Using \texttt{log} changes the interpretation of the coefficient \(\beta\) in terms of scales.
\end{itemize}

\begin{longtable}[]{@{}lll@{}}
\toprule
Dependent variable & Explanatory variable & interpretation\tabularnewline
\midrule
\endhead
\(Y\) & \(X\) & 1 unit increase in \(X\) causes \(\beta\) units change in Y\tabularnewline
\(\log Y\) & \(X\) & 1 unit increase in \(X\) causes \(100 \beta \%\) incchangerease in \(Y\)\tabularnewline
\(Y\) & \(\log X\) & \(1\%\) increase in \(X\) causes \(\beta / 100\) unit change in \(Y\)\tabularnewline
\(\log Y\) & \(\log X\) & \(1\%\) increase in \(X\) causes \(\beta \%\) change in \(Y\)\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{dummy-variable}{%
\subsection{Dummy variable}\label{dummy-variable}}

\begin{itemize}
\tightlist
\item
  A dummy variable takes only 1 or 0. This is used to express qualititative information
\item
  Example: Dummy variable for race
  \[
  white_{i}=\begin{cases}
  1 & if\ white\\
  0 & otherwise
  \end{cases} 
   \]
\item
  The coefficient on a dummy variable captures the difference of the outcome \(Y\) between categories
\item
  Consider the linear regression
  \[
    Y_i = \beta_0 + \beta_1 white_i + \epsilon_i
    \]
  The coefficient \(\beta_1\) captures the difference of \(Y\) between white and non-white people.
\end{itemize}

\hypertarget{interaction-term}{%
\subsection{Interaction term}\label{interaction-term}}

\begin{itemize}
\tightlist
\item
  You can add the interaction of two explanatory variables in the regression model.
\item
  For example:
  \[
    wage_i = \beta_0 + \beta_1 educ_i + \beta_2 educ_i \times white_i + \epsilon_i
    \]
  where \(wage_i\) is the earnings of person \(i\) and \(educ_i\) is the years of schooling for person \(i\).
\item
  The effect of \(educ_i\) is
  \[
    \frac{\partial wage_i}{\partial educ_i} = \beta_1 + \beta_2 white_i,
  \]
\item
  This allows for heterogenous effects of education across races.
\end{itemize}

\hypertarget{measures-of-fit}{%
\section{Measures of Fit}\label{measures-of-fit}}

\begin{itemize}
\tightlist
\item
  We often use \(R^2\) as a measure of the model fit.
\item
  Denote \textbf{the fitted value} as \(\hat{y}_i\)
  \[
   \hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_{i1} + \cdots + \hat{\beta}_K X_{iK}
  \]

  \begin{itemize}
  \tightlist
  \item
    Also called prediction from the OLS regression.
  \end{itemize}
\item
  \(R^2\) is defined as
  \[
    R^2 = \frac{SSE}{TSS},
    \]
  where
  \[ 
     \  SSE = \sum_i (\hat{y}_i - \bar{y})^2, \ TSS = \sum_i (y_i - \bar{y})^2
    \]
\item
  \(R^2\) captures the fraction of the variation of \(Y\) explained by the regression model.
\item
  Adding variables always (weakly) increases \(R^2\).
\item
  In a regression model with multiple explanatory variables, we often use \textbf{adjusted} \(R^2\) that adjusts the number of explanatory variables
  \[
    \bar{R}^2 = 1 - \frac{N-1}{N-(K+1)} \frac{SSR}{TSS}
  \]
  where
  \[
    SSR = \sum_i (\hat{y}_i - y_i)^2 (= \sum_i \hat{u}_i^2 ),
    \]
\end{itemize}

\hypertarget{statistical-inference}{%
\section{Statistical Inference}\label{statistical-inference}}

\begin{itemize}
\tightlist
\item
  Notice that the OLS estimators are \textbf{random variables}. They depend on the data, which are random variables drawn from some population distribution.
\item
  We can conduct statistical inferences regarding those OLS estimators:
  1. Hypothesis testing
  2. Constructing confidence interval
\item
  I first explain the sampling distribution of the OLS estimators.
\end{itemize}

\hypertarget{distribution-of-the-ols-estimators-based-on-asymptotic-theory}{%
\subsection{Distribution of the OLS estimators based on asymptotic theory}\label{distribution-of-the-ols-estimators-based-on-asymptotic-theory}}

\begin{itemize}
\tightlist
\item
  Deriving the exact (finite-sample) distribution of the OLS estimators is very hard.

  \begin{itemize}
  \tightlist
  \item
    The OLS estimators depend on the data \(Y_i, X_i\) in a complex way.
  \item
    We typically do not know the distribution of \(Y\) and \(X\).
  \end{itemize}
\item
  We rely on \textbf{asymptotic} argument. We approximate the sampling distribution of the OLS esimator based on the cental limit theorem.
\item
  Under the OLS assumption, the OLS estimator has \textbf{asymptotic normality}
  \[
  \sqrt{N}(\hat{\beta}-\beta)\overset{d}{\rightarrow}N\left(0,V \right)    
    \]
  where
  \[
    \underbrace{V}_{(K+1)\times(K+1)}
     = E[\mathbf{x}_{i}'\mathbf{x}_{i}]^{-1}E[\mathbf{x}_{i}'\mathbf{x}_{i}\epsilon_{i}^{2}]E[\mathbf{x}_{i}'\mathbf{x}_{i}]^{-1}
    \]
  and
  \[
    \underbrace{\mathbf{x}_{i}}_{(K+1)\times1}=\left(\begin{array}{c}
  1\\
  X_{i1}\\
  \vdots\\
  X_{iK}
  \end{array}\right)
    \]
\item
  We can \textbf{approximate} the distribution of \(\hat{\beta}\) by
  \[
    \hat{\beta} \sim N(\beta, V / N)
    \]
\item
  The above is joint distribution. Let \(V_{ij}\) be the \((i,j)\) element of the matrix \(V\).
\item
  The individual coefficient \(\beta_k\) follows
  \[
   \hat\beta_k \sim N(\beta_k, V_{kk} / N )
  \]
\end{itemize}

\hypertarget{estimation-of-asymptotic-variance}{%
\subsubsection{Estimation of Asymptotic Variance}\label{estimation-of-asymptotic-variance}}

\begin{itemize}
\tightlist
\item
  \(V\) is an unknown object. Need to be estimated.
\item
  Consider the estimator \(\hat{V}\) for \(V\) using sample analogues
  \[
    \hat{V}=\left(\frac{1}{N}\sum_{i=1}^{N}\mathbf{x}_{i}'\mathbf{x}_{i}\right)^{-1}\left(\frac{1}{N}\sum_{i=1}^{N}\mathbf{x}_{i}'\mathbf{x}_{i}\hat{\epsilon}_{i}^{2}\right)\left(\frac{1}{N}\sum_{i=1}^{N}\mathbf{x}_{i}'\mathbf{x}_{i}\right)^{-1}
  \]
  where \(\hat{\epsilon}_i = y_i - (\hat{\beta}_0 + \cdots + \hat{\beta}_K X_{iK})\) is the residual.
\item
  Technically speaking, \(\hat{V}\) converges to \(V\) in probability. (Proof is out of the scope of this course)
\item
  We often use the (asymptotic) \textbf{standard error} \(SE(\hat{\beta_k}) = \sqrt{\hat{V}_{kk} / N }\).
\item
  The standard error is an estimator for the standard deviation of the OLS estimator \(\hat{\beta_k}\).
\end{itemize}

\hypertarget{hypothesis-testing-2}{%
\subsection{Hypothesis testing}\label{hypothesis-testing-2}}

\begin{itemize}
\item
  OLS estimator is the random variable.
\item
  You might want to test a particular hypothesis regarding those coefficients.

  \begin{itemize}
  \tightlist
  \item
    Does x really affects y?
  \item
    Is the production technology the constant returns to scale?
  \end{itemize}
\item
  Here I explain how to conduct hypothesis testing.
\item
  Step 1: Consider the null hypothesis \(H_{0}\) and the alternative hypothesis \(H_{1}\)
  \[
    H_{0}:\beta_{1}=k,H_{1}:\beta_{1}\neq k
    \]
  where \(k\) is the known number you set by yourself.
\item
  Step 2: Define \textbf{t-statistic} by
  \[
    t_{n}=\frac{\hat{\beta_1}-k}{SE(\hat{\beta_1})}
    \]
\item
  Step 3: We reject \(H_{0}\) is at \(\alpha\)-percent significance level if
  \[|t_{n}|>C_{\alpha/2} 
  \]
  where \(C_{\alpha/2}\) is the \(\alpha/2\) percentile of the standard normal distribution.

  \begin{itemize}
  \tightlist
  \item
    We say we \textbf{fail to reject} \(H_0\) if the above does not hold.
  \end{itemize}
\end{itemize}

\hypertarget{caveats-on-hypothesis-testing}{%
\subsubsection{Caveats on Hypothesis Testing}\label{caveats-on-hypothesis-testing}}

\begin{itemize}
\tightlist
\item
  We often say \(\hat{\beta}\) is \textbf{statistically significant} at \(5\%\) level if \(|t_{n}|>1.96\) when we set \(k=0\).
\item
  Arguing the statistical significance alone is not enough for argument in empirical analysis.
\item
  Magnitude of the coefficient is also important.
\item
  Case 1: Small but statistically significant coefficient.

  \begin{itemize}
  \tightlist
  \item
    As the sample size \(N\) gets large, the \(SE\) decreases.
  \end{itemize}
\item
  Case 2: Large but statistically insignificant coefficient.

  \begin{itemize}
  \tightlist
  \item
    The variable might have an important (economically meaningful) effect.
  \item
    But you may not be able to estimate the effect precisely with the sample at your hand.
  \end{itemize}
\end{itemize}

\hypertarget{f-test}{%
\subsubsection{F test}\label{f-test}}

\begin{itemize}
\tightlist
\item
  We often test a composite hypothesis that involves multiple parameters such as
  \[
   H_{0}:\beta_{1} + \beta_2 = 0,\ H_{1}:\beta_{1} + \beta_2 \neq 0
    \]
\item
  We use \textbf{F test} in such a case (to be added).
\end{itemize}

\hypertarget{confidence-interval}{%
\subsection{Confidence interval}\label{confidence-interval}}

\begin{itemize}
\tightlist
\item
  95\% confidence interval
  \[
    CI_{n}  =\left\{ k:|\frac{\hat{\beta}_{1}-k}{SE(\hat{\beta}_{1})}|\leq1.96\right\} 
    =\left[\hat{\beta}_{1}-1.96\times SE(\hat{\beta}_{1}),\hat{\beta_{1}}+1.96\times SE(\hat{\beta}_{1})\right]
  \]
\item
  Interpretation: If you draw many samples (dataset) and construct the 95\% CI for each sample, 95\% of those CIs will include the true parameter.
\end{itemize}

\hypertarget{homoskedasticity-vs-heteroskedasticity}{%
\subsection{Homoskedasticity vs Heteroskedasticity}\label{homoskedasticity-vs-heteroskedasticity}}

\begin{itemize}
\tightlist
\item
  So far, we did not put any assumption on the variance of the error term \(\epsilon_i\).
\item
  The error term \(\epsilon_{i}\) has \textbf{heteroskedasticity} if \(Var(u_{i}|X_{i})\) depends on \(X_{i}\).
\item
  If not, we call \(\epsilon_{i}\) has \textbf{homoskedasticity}.
\item
  This has an important implication on the asymptotic variance.
\item
  Remember the asymptotic variance
  \[
    \underbrace{V}_{(K+1)\times(K+1)}
     = E[\mathbf{x}_{i}'\mathbf{x}_{i}]^{-1}E[\mathbf{x}_{i}'\mathbf{x}_{i}\epsilon_{i}^{2}]E[\mathbf{x}_{i}'\mathbf{x}_{i}]^{-1}
    \]
  Standard errors based on this is called \textbf{heteroskedasticity robust standard errors}/
\item
  If homoskedasticity holds, then
  \[
    V = E[\mathbf{x}_{i}'\mathbf{x}_{i}]^{-1}\sigma^{2}
    \]
  where \(\sigma^2 = V(\epsilon_i)\).
\item
  In many statistical packages (including R and Stata), the standard errors for the OLS estimators are calcualted under homoskedasticity assumption as a default.
\item
  However, if the error has heteroskedasticity, the standard error under homoskedasticity assumption will be \textbf{underestimated}.
\item
  In OLS, \textbf{we should always use heteroskedasticity robust standard error.}

  \begin{itemize}
  \tightlist
  \item
    We will see how to fix this in R.
  \end{itemize}
\end{itemize}

\hypertarget{linear-regression-2-implementation-in-r}{%
\chapter{Linear Regression 2: Implementation in R}\label{linear-regression-2-implementation-in-r}}

\hypertarget{implementation-in-r}{%
\section{Implementation in R}\label{implementation-in-r}}

\hypertarget{preliminary-packages}{%
\subsection{Preliminary: packages}\label{preliminary-packages}}

\begin{itemize}
\tightlist
\item
  We use the following packages:

  \begin{itemize}
  \tightlist
  \item
    \texttt{AER} :
  \item
    \texttt{dplyr} : data manipulation
  \item
    \texttt{stargazer} : output of regression results
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Install package if you have not done so }
\CommentTok{# install.packages("AER")}
\CommentTok{# install.packages("dplyr")}
\CommentTok{# install.packages("stargazer")}
\CommentTok{# install.packages("lmtest")}

\CommentTok{# load packages}
\KeywordTok{library}\NormalTok{(}\StringTok{"AER"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{"dplyr"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{"stargazer"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{"lmtest"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{empirical-setting-data-from-california-school}{%
\subsection{Empirical setting: Data from California School}\label{empirical-setting-data-from-california-school}}

\begin{itemize}
\tightlist
\item
  Question: How does the student-teacher ratio affects test scores?
\item
  We use data from California school, which is included in \texttt{AER} package.

  \begin{itemize}
  \tightlist
  \item
    See here for the details: \url{https://www.rdocumentation.org/packages/AER/versions/1.2-6/topics/CASchools}
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# load the the data set in the workspace}
\KeywordTok{data}\NormalTok{(CASchools)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Use \texttt{class()} function to see \texttt{CASchools} is \texttt{data.frame} object.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{class}\NormalTok{(CASchools)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "data.frame"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  We take 2 steps for the analysis.

  \begin{itemize}
  \tightlist
  \item
    Step 1: Look at data (descriptive analysis)
  \item
    Step 2: Run regression
  \end{itemize}
\end{itemize}

\hypertarget{step-1-descriptive-analysis}{%
\subsection{Step 1: Descriptive analysis}\label{step-1-descriptive-analysis}}

\begin{itemize}
\tightlist
\item
  It is always important to grasp your data before running regression.
\item
  \texttt{head()} function give you a first overview of the data.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(CASchools)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   district                          school  county grades students
## 1    75119              Sunol Glen Unified Alameda  KK-08      195
## 2    61499            Manzanita Elementary   Butte  KK-08      240
## 3    61549     Thermalito Union Elementary   Butte  KK-08     1550
## 4    61457 Golden Feather Union Elementary   Butte  KK-08      243
## 5    61523        Palermo Union Elementary   Butte  KK-08     1335
## 6    62042         Burrel Union Elementary  Fresno  KK-08      137
##   teachers calworks   lunch computer expenditure    income   english  read
## 1    10.90   0.5102  2.0408       67    6384.911 22.690001  0.000000 691.6
## 2    11.15  15.4167 47.9167      101    5099.381  9.824000  4.583333 660.5
## 3    82.90  55.0323 76.3226      169    5501.955  8.978000 30.000002 636.3
## 4    14.00  36.4754 77.0492       85    7101.831  8.978000  0.000000 651.9
## 5    71.50  33.1086 78.4270      171    5235.988  9.080333 13.857677 641.8
## 6     6.40  12.3188 86.9565       25    5580.147 10.415000 12.408759 605.7
##    math
## 1 690.0
## 2 661.9
## 3 650.9
## 4 643.5
## 5 639.9
## 6 605.4
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Alternatively, you can use \texttt{browse()} to see the entire dataset in browser window.
\end{itemize}

\hypertarget{create-variables}{%
\subsubsection{Create variables}\label{create-variables}}

\begin{itemize}
\tightlist
\item
  Create several variables that are needed for the analysis.
\item
  We use \texttt{dplyr} for this purpose.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CASchools }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{( }\DataTypeTok{STR =}\NormalTok{ students }\OperatorTok{/}\StringTok{ }\NormalTok{teachers ) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{mutate}\NormalTok{( }\DataTypeTok{score =}\NormalTok{ (read }\OperatorTok{+}\StringTok{ }\NormalTok{math) }\OperatorTok{/}\StringTok{ }\DecValTok{2}\NormalTok{ ) ->}\StringTok{ }\NormalTok{CASchools }
\end{Highlighting}
\end{Shaded}

\hypertarget{descriptive-statistics}{%
\subsubsection{Descriptive statistics}\label{descriptive-statistics}}

\begin{itemize}
\tightlist
\item
  There are several ways to show descriptive statistics
\item
  The standard one is to use \texttt{summary()} function
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(CASchools)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    district            school                  county      grades   
##  Length:420         Length:420         Sonoma     : 29   KK-06: 61  
##  Class :character   Class :character   Kern       : 27   KK-08:359  
##  Mode  :character   Mode  :character   Los Angeles: 27              
##                                        Tulare     : 24              
##                                        San Diego  : 21              
##                                        Santa Clara: 20              
##                                        (Other)    :272              
##     students          teachers          calworks          lunch       
##  Min.   :   81.0   Min.   :   4.85   Min.   : 0.000   Min.   :  0.00  
##  1st Qu.:  379.0   1st Qu.:  19.66   1st Qu.: 4.395   1st Qu.: 23.28  
##  Median :  950.5   Median :  48.56   Median :10.520   Median : 41.75  
##  Mean   : 2628.8   Mean   : 129.07   Mean   :13.246   Mean   : 44.71  
##  3rd Qu.: 3008.0   3rd Qu.: 146.35   3rd Qu.:18.981   3rd Qu.: 66.86  
##  Max.   :27176.0   Max.   :1429.00   Max.   :78.994   Max.   :100.00  
##                                                                       
##     computer       expenditure       income          english      
##  Min.   :   0.0   Min.   :3926   Min.   : 5.335   Min.   : 0.000  
##  1st Qu.:  46.0   1st Qu.:4906   1st Qu.:10.639   1st Qu.: 1.941  
##  Median : 117.5   Median :5215   Median :13.728   Median : 8.778  
##  Mean   : 303.4   Mean   :5312   Mean   :15.317   Mean   :15.768  
##  3rd Qu.: 375.2   3rd Qu.:5601   3rd Qu.:17.629   3rd Qu.:22.970  
##  Max.   :3324.0   Max.   :7712   Max.   :55.328   Max.   :85.540  
##                                                                   
##       read            math            STR            score      
##  Min.   :604.5   Min.   :605.4   Min.   :14.00   Min.   :605.5  
##  1st Qu.:640.4   1st Qu.:639.4   1st Qu.:18.58   1st Qu.:640.0  
##  Median :655.8   Median :652.5   Median :19.72   Median :654.5  
##  Mean   :655.0   Mean   :653.3   Mean   :19.64   Mean   :654.2  
##  3rd Qu.:668.7   3rd Qu.:665.9   3rd Qu.:20.87   3rd Qu.:666.7  
##  Max.   :704.0   Max.   :709.5   Max.   :25.80   Max.   :706.8  
## 
\end{verbatim}

\begin{itemize}
\tightlist
\item
  This returns the desriptive statistics for all the variables in dataframe.
\item
  You can combine this with \texttt{dplyr::select}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CASchools }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(STR, score) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       STR            score      
##  Min.   :14.00   Min.   :605.5  
##  1st Qu.:18.58   1st Qu.:640.0  
##  Median :19.72   Median :654.5  
##  Mean   :19.64   Mean   :654.2  
##  3rd Qu.:20.87   3rd Qu.:666.7  
##  Max.   :25.80   Max.   :706.8
\end{verbatim}

\begin{itemize}
\tightlist
\item
  You can do a bit lengthly thing manually like this.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# compute sample averages of STR and score}
\NormalTok{avg_STR <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{STR) }
\NormalTok{avg_score <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{score)}

\CommentTok{# compute sample standard deviations of STR and score}
\NormalTok{sd_STR <-}\StringTok{ }\KeywordTok{sd}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{STR) }
\NormalTok{sd_score <-}\StringTok{ }\KeywordTok{sd}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{score)}

\CommentTok{# set up a vector of percentiles and compute the quantiles }
\NormalTok{quantiles <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.10}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.6}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\FloatTok{0.9}\NormalTok{)}
\NormalTok{quant_STR <-}\StringTok{ }\KeywordTok{quantile}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{STR, quantiles)}
\NormalTok{quant_score <-}\StringTok{ }\KeywordTok{quantile}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{score, quantiles)}

\CommentTok{# gather everything in a data.frame }
\NormalTok{DistributionSummary <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{Average =} \KeywordTok{c}\NormalTok{(avg_STR, avg_score), }
                                  \DataTypeTok{StandardDeviation =} \KeywordTok{c}\NormalTok{(sd_STR, sd_score), }
                                  \DataTypeTok{quantile =} \KeywordTok{rbind}\NormalTok{(quant_STR, quant_score))}

\CommentTok{# print the summary to the console}
\NormalTok{DistributionSummary}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Average StandardDeviation quantile.10. quantile.25.
## quant_STR    19.64043          1.891812      17.3486     18.58236
## quant_score 654.15655         19.053347     630.3950    640.05000
##             quantile.40. quantile.50. quantile.60. quantile.75.
## quant_STR       19.26618     19.72321      20.0783     20.87181
## quant_score    649.06999    654.45000     659.4000    666.66249
##             quantile.90.
## quant_STR       21.86741
## quant_score    678.85999
\end{verbatim}

\begin{itemize}
\tightlist
\item
  My personal favorite is to use \texttt{stargazer} function.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{stargazer}\NormalTok{(CASchools, }\DataTypeTok{type =} \StringTok{"text"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ===========================================================================
## Statistic    N    Mean    St. Dev.     Min    Pctl(25)  Pctl(75)     Max   
## ---------------------------------------------------------------------------
## students    420 2,628.793 3,913.105    81        379      3,008    27,176  
## teachers    420  129.067   187.913    4.850    19.662    146.350  1,429.000
## calworks    420  13.246    11.455     0.000     4.395    18.981    78.994  
## lunch       420  44.705    27.123     0.000    23.282    66.865    100.000 
## computer    420  303.383   441.341      0        46       375.2     3,324  
## expenditure 420 5,312.408  633.937  3,926.070 4,906.180 5,601.401 7,711.507
## income      420  15.317     7.226     5.335    10.639    17.629    55.328  
## english     420  15.768    18.286       0        1.9      23.0       86    
## read        420  654.970   20.108    604.500   640.400   668.725   704.000 
## math        420  653.343   18.754      605      639.4     665.8      710   
## STR         420  19.640     1.892    14.000    18.582    20.872    25.800  
## score       420  654.157   19.053    605.550   640.050   666.662   706.750 
## ---------------------------------------------------------------------------
\end{verbatim}

\begin{itemize}
\tightlist
\item
  You can choose summary statistics you want to report.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CASchools }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{stargazer}\NormalTok{( }\DataTypeTok{type =} \StringTok{"text"}\NormalTok{, }\DataTypeTok{summary.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"n"}\NormalTok{, }\StringTok{"p75"}\NormalTok{, }\StringTok{"sd"}\NormalTok{) ) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ===================================
## Statistic    N  Pctl(75)  St. Dev. 
## -----------------------------------
## students    420   3,008   3,913.105
## teachers    420  146.350   187.913 
## calworks    420  18.981    11.455  
## lunch       420  66.865    27.123  
## computer    420   375.2    441.341 
## expenditure 420 5,601.401  633.937 
## income      420  17.629     7.226  
## english     420   23.0     18.286  
## read        420  668.725   20.108  
## math        420   665.8    18.754  
## STR         420  20.872     1.892  
## score       420  666.662   19.053  
## -----------------------------------
\end{verbatim}

\begin{itemize}
\tightlist
\item
  See \url{https://www.jakeruss.com/cheatsheets/stargazer/\#the-default-summary-statistics-table} for the details.
\item
  We will use \texttt{stargazer} to report regression results.
\end{itemize}

\hypertarget{scatter-plot}{%
\subsubsection{Scatter plot}\label{scatter-plot}}

\begin{itemize}
\tightlist
\item
  Let's see how test score and student-teacher-ratio is correlated.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{STR, }
     \DataTypeTok{data =}\NormalTok{ CASchools,}
     \DataTypeTok{main =} \StringTok{"Scatterplot of TestScore and STR"}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"STR (X)"}\NormalTok{,}
     \DataTypeTok{ylab =} \StringTok{"Test Score (Y)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Econometrics_using_R_files/figure-latex/unnamed-chunk-123-1.pdf}

\begin{itemize}
\tightlist
\item
  Use \texttt{cor()} to compute the correlation between two numeric vectors.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{cor}\NormalTok{(CASchools}\OperatorTok{$}\NormalTok{STR, CASchools}\OperatorTok{$}\NormalTok{score)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.2263627
\end{verbatim}

\hypertarget{step-2-run-regression}{%
\subsection{Step 2: Run regression}\label{step-2-run-regression}}

\hypertarget{simple-linear-regression}{%
\subsubsection{Simple linear regression}\label{simple-linear-regression}}

\begin{itemize}
\tightlist
\item
  We use \texttt{lm()} function to run linear regression
\item
  First, consider the simple linear regression
  \[
  score_i = \beta_0 + \beta_1 size_i + \epsilon_i
  \]
  where \(size_i\) is the class size (student-teacher-ratio).

  \begin{itemize}
  \tightlist
  \item
    From now on we call student-teacher-ratio (STR) class size.
  \end{itemize}
\item
  To run this regression, we use \texttt{lm}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# First, we rename the variable `STR`}
\NormalTok{CASchools }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\NormalTok{dplyr}\OperatorTok{::}\KeywordTok{rename}\NormalTok{( }\DataTypeTok{size =}\NormalTok{ STR) ->}\StringTok{ }\NormalTok{CASchools}

\CommentTok{# Run regression and save results in the varaiable `model1_summary`}
\NormalTok{model1_summary <-}\StringTok{ }\KeywordTok{lm}\NormalTok{( score }\OperatorTok{~}\StringTok{ }\NormalTok{size, }\DataTypeTok{data =}\NormalTok{ CASchools)}

\CommentTok{# See the results}
\KeywordTok{summary}\NormalTok{(model1_summary)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = score ~ size, data = CASchools)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.727 -14.251   0.483  12.822  48.540 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 698.9329     9.4675  73.825  < 2e-16 ***
## size         -2.2798     0.4798  -4.751 2.78e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.58 on 418 degrees of freedom
## Multiple R-squared:  0.05124,    Adjusted R-squared:  0.04897 
## F-statistic: 22.58 on 1 and 418 DF,  p-value: 2.783e-06
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Interpretations

  \begin{itemize}
  \tightlist
  \item
    An increase of one student per teacher leads to 2.2 point decrease in test scores.
  \item
    p value is very small. The effect of the class size on test score is significant.
    Note: Be careful. These standard errors are NOT heteroskedasiticity robust. We will come back to this point soon.
  \item
    \(R^2 = 0.051\), implying that 5.1\% of the variance of the dependent variable is explained by the model.
  \end{itemize}
\item
  You can add more variable in the regression (will see this soon)
\end{itemize}

\hypertarget{correction-of-robust-standard-error}{%
\subsubsection{Correction of Robust standard error}\label{correction-of-robust-standard-error}}

\begin{itemize}
\tightlist
\item
  We use \texttt{vcovHC()} function, a partof the package \texttt{sandwich}, to obtain the robust standard errors.

  \begin{itemize}
  \tightlist
  \item
    The package \texttt{sandwich} is automatically loaded if you load \texttt{AER} package.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# compute heteroskedasticity-robust standard errors}
\NormalTok{vcov <-}\StringTok{ }\KeywordTok{vcovHC}\NormalTok{(model1_summary, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{)}

\CommentTok{# get standard error: the square root of the diagonal element in vcov}
\NormalTok{robust_se <-}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(vcov))}
\NormalTok{robust_se}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## (Intercept)        size 
##  10.3643617   0.5194893
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Notice that robust standard errors are larger than the one we obtained from \texttt{lm}!
\item
  How to combine the robust standard errors with the original summary? Use \texttt{coeftest()} from the package \texttt{lmtest}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# load `lmtest`}
\KeywordTok{library}\NormalTok{(lmtest)}

\CommentTok{# Combine robust standard errors}
\KeywordTok{coeftest}\NormalTok{(model1_summary, }\DataTypeTok{vcov. =}\NormalTok{ vcov)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## t test of coefficients:
## 
##              Estimate Std. Error t value  Pr(>|t|)    
## (Intercept) 698.93295   10.36436 67.4362 < 2.2e-16 ***
## size         -2.27981    0.51949 -4.3886 1.447e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{report-by-stargazer}{%
\subsubsection{Report by Stargazer}\label{report-by-stargazer}}

\begin{itemize}
\tightlist
\item
  \texttt{stargazer} is useful to show the regression result.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# load}
\KeywordTok{library}\NormalTok{(stargazer)}

\CommentTok{# Create output by stargazer}
\NormalTok{stargazer}\OperatorTok{::}\KeywordTok{stargazer}\NormalTok{(model1_summary, }\DataTypeTok{type =}\StringTok{"text"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ===============================================
##                         Dependent variable:    
##                     ---------------------------
##                                score           
## -----------------------------------------------
## size                         -2.280***         
##                               (0.480)          
##                                                
## Constant                    698.933***         
##                               (9.467)          
##                                                
## -----------------------------------------------
## Observations                    420            
## R2                             0.051           
## Adjusted R2                    0.049           
## Residual Std. Error      18.581 (df = 418)     
## F Statistic           22.575*** (df = 1; 418)  
## ===============================================
## Note:               *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Use robust standard errors in stargazer output
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Prepare robust standard errors in list}
\NormalTok{rob_se <-}\StringTok{ }\KeywordTok{list}\NormalTok{( }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(model1_summary, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{) ) ) ) }

\CommentTok{# generate regression table. }

\KeywordTok{stargazer}\NormalTok{( model1_summary, }
           \DataTypeTok{se =}\NormalTok{ rob_se, }
           \DataTypeTok{type =} \StringTok{"text"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ===============================================
##                         Dependent variable:    
##                     ---------------------------
##                                score           
## -----------------------------------------------
## size                         -2.280***         
##                               (0.519)          
##                                                
## Constant                    698.933***         
##                              (10.364)          
##                                                
## -----------------------------------------------
## Observations                    420            
## R2                             0.051           
## Adjusted R2                    0.049           
## Residual Std. Error      18.581 (df = 418)     
## F Statistic           22.575*** (df = 1; 418)  
## ===============================================
## Note:               *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}

\hypertarget{full-results}{%
\subsubsection{Full results}\label{full-results}}

Taken from \url{https://www.econometrics-with-r.org/7-6-analysis-of-the-test-score-data-set.html}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# load the stargazer library}

\CommentTok{# estimate different model specifications}
\NormalTok{spec1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{size, }\DataTypeTok{data =}\NormalTok{ CASchools)}
\NormalTok{spec2 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{size }\OperatorTok{+}\StringTok{ }\NormalTok{english, }\DataTypeTok{data =}\NormalTok{ CASchools)}
\NormalTok{spec3 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{size }\OperatorTok{+}\StringTok{ }\NormalTok{english }\OperatorTok{+}\StringTok{ }\NormalTok{lunch, }\DataTypeTok{data =}\NormalTok{ CASchools)}
\NormalTok{spec4 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{size }\OperatorTok{+}\StringTok{ }\NormalTok{english }\OperatorTok{+}\StringTok{ }\NormalTok{calworks, }\DataTypeTok{data =}\NormalTok{ CASchools)}
\NormalTok{spec5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(score }\OperatorTok{~}\StringTok{ }\NormalTok{size }\OperatorTok{+}\StringTok{ }\NormalTok{english }\OperatorTok{+}\StringTok{ }\NormalTok{lunch }\OperatorTok{+}\StringTok{ }\NormalTok{calworks, }\DataTypeTok{data =}\NormalTok{ CASchools)}

\CommentTok{# gather robust standard errors in a list}
\NormalTok{rob_se <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(spec1, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{))),}
               \KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(spec2, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{))),}
               \KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(spec3, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{))),}
               \KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(spec4, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{))),}
               \KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\KeywordTok{vcovHC}\NormalTok{(spec5, }\DataTypeTok{type =} \StringTok{"HC1"}\NormalTok{))))}

\CommentTok{# generate a LaTeX table using stargazer}
\KeywordTok{stargazer}\NormalTok{(spec1, spec2, spec3, spec4, spec5,}
          \DataTypeTok{se =}\NormalTok{ rob_se,}
          \DataTypeTok{digits =} \DecValTok{3}\NormalTok{,}
          \DataTypeTok{header =}\NormalTok{ F,}
          \DataTypeTok{column.labels =} \KeywordTok{c}\NormalTok{(}\StringTok{"(I)"}\NormalTok{, }\StringTok{"(II)"}\NormalTok{, }\StringTok{"(III)"}\NormalTok{, }\StringTok{"(IV)"}\NormalTok{, }\StringTok{"(V)"}\NormalTok{),}
          \DataTypeTok{type =}\StringTok{"text"}\NormalTok{, }
          \DataTypeTok{keep.stat =} \KeywordTok{c}\NormalTok{(}\StringTok{"N"}\NormalTok{, }\StringTok{"adj.rsq"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ===================================================================
##                               Dependent variable:                  
##              ------------------------------------------------------
##                                      score                         
##                 (I)        (II)      (III)       (IV)       (V)    
##                 (1)        (2)        (3)        (4)        (5)    
## -------------------------------------------------------------------
## size         -2.280***   -1.101**  -0.998***  -1.308***  -1.014*** 
##               (0.519)    (0.433)    (0.270)    (0.339)    (0.269)  
##                                                                    
## english                 -0.650***  -0.122***  -0.488***  -0.130*** 
##                          (0.031)    (0.033)    (0.030)    (0.036)  
##                                                                    
## lunch                              -0.547***             -0.529*** 
##                                     (0.024)               (0.038)  
##                                                                    
## calworks                                      -0.790***    -0.048  
##                                                (0.068)    (0.059)  
##                                                                    
## Constant     698.933*** 686.032*** 700.150*** 697.999*** 700.392***
##               (10.364)   (8.728)    (5.568)    (6.920)    (5.537)  
##                                                                    
## -------------------------------------------------------------------
## Observations    420        420        420        420        420    
## Adjusted R2    0.049      0.424      0.773      0.626      0.773   
## ===================================================================
## Note:                                   *p<0.1; **p<0.05; ***p<0.01
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The coefficient on the class size decreases as we add more explantory variables. Can you explain why? (Hint: omitted variable bias)
\end{itemize}


\end{document}
