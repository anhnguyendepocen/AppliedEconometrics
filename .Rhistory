# Show result
stargazer(result_OLS, result_IV, type ="text", se = rob_se)
# First stage regression
result_1st <- lm(educ ~ motheduc + fatheduc + exper + expersq, data = data)
# F test
linearHypothesis(result_1st,
c("fatheduc = 0", "motheduc = 0" ),
vcov = vcovHC, type = "HC1")
# load the data set and get an overview
library(AER)
data("CigarettesSW")
summary(CigarettesSW)
library(dplyr)
CigarettesSW %>%
mutate( rincome = (income / population) / cpi) %>%
mutate( rprice  = price / cpi ) %>%
mutate( salestax = (taxs - tax) / cpi ) %>%
mutate( cigtax = tax/cpi ) -> Cigdata
cig_ols <- lm(log(packs) ~ log(rprice) + log(rincome) ,  data = Cigdata)
coeftest(cig_ols, vcov = vcovHC, type = "HC1")
cig_ivreg <- ivreg(log(packs) ~ log(rprice) + log(rincome)  |
log(rincome) +  salestax , data = Cigdata)
coeftest(cig_ivreg, vcov = vcovHC, type = "HC1")
# Robust standard errors
rob_se <- list(sqrt(diag(vcovHC(cig_ols, type = "HC1"))),
sqrt(diag(vcovHC(cig_ivreg, type = "HC1"))))
# Show result
stargazer(cig_ols, cig_ivreg, type ="text", se = rob_se)
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestaxdata + cigtax , data= Cigdata)
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestate + cigtax , data= Cigdata)
cig_ols <- lm(log(packs) ~ log(rprice) + log(rincome) ,  data = Cigdata)
coeftest(cig_ols, vcov = vcovHC, type = "HC1")
cig_ivreg <- ivreg(log(packs) ~ log(rprice) + log(rincome)  |
log(rincome) +  salestax +  cigtax, data = Cigdata)
coeftest(cig_ivreg, vcov = vcovHC, type = "HC1")
# Robust standard errors
rob_se <- list(sqrt(diag(vcovHC(cig_ols, type = "HC1"))),
sqrt(diag(vcovHC(cig_ivreg, type = "HC1"))))
# Show result
stargazer(cig_ols, cig_ivreg, type ="text", se = rob_se)
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestate + cigtax , data= Cigdata)
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestax + cigtax , data= Cigdata)
# F test
linearHypothesis(result_1st,
c("fatheduc = 0", "motheduc = 0" ),
vcov = vcovHC, type = "HC1")
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestax + cigtax , data= Cigdata)
# F test
linearHypothesis(result_1st,
c("salestax = 0", "cigtax = 0" ),
vcov = vcovHC, type = "HC1")
library(readr)
HGdata <- read_csv("HansfordGomez_Data.csv")
summary(HGdata)
stargazer::stargazer(HGdata, type="text")
stargazer::stargazer(as.data.frame(HGdata), type="text")
library("foreign")
# You might get a message "cannot read factor labels from Stata 5 files", but you do not have to worry about it.
data <- read.dta("MROZ.DTA")
library(stargazer)
stargazer(data, type = "text")
library("AER")
library("dplyr")
# data cleaning
data %>%
select(lwage, educ, exper, expersq, motheduc, fatheduc) %>%
filter( is.na(lwage) == 0 ) -> data
# OLS regression
result_OLS <- lm( lwage ~ educ + exper + expersq, data = data)
# IV regression using fathereduc and mothereduc
result_IV <- ivreg(lwage ~ educ + exper + expersq | fatheduc + motheduc + exper + expersq, data = data)
# Robust standard errors
# gather robust standard errors in a list
rob_se <- list(sqrt(diag(vcovHC(result_OLS, type = "HC1"))),
sqrt(diag(vcovHC(result_IV, type = "HC1"))))
# Show result
stargazer(result_OLS, result_IV, type ="text", se = rob_se)
# First stage regression
result_1st <- lm(educ ~ motheduc + fatheduc + exper + expersq, data = data)
# F test
linearHypothesis(result_1st,
c("fatheduc = 0", "motheduc = 0" ),
vcov = vcovHC, type = "HC1")
# load the data set and get an overview
library(AER)
data("CigarettesSW")
summary(CigarettesSW)
library(dplyr)
CigarettesSW %>%
mutate( rincome = (income / population) / cpi) %>%
mutate( rprice  = price / cpi ) %>%
mutate( salestax = (taxs - tax) / cpi ) %>%
mutate( cigtax = tax/cpi ) -> Cigdata
cig_ols <- lm(log(packs) ~ log(rprice) + log(rincome) ,  data = Cigdata)
coeftest(cig_ols, vcov = vcovHC, type = "HC1")
cig_ivreg <- ivreg(log(packs) ~ log(rprice) + log(rincome)  |
log(rincome) +  salestax +  cigtax, data = Cigdata)
coeftest(cig_ivreg, vcov = vcovHC, type = "HC1")
# Robust standard errors
rob_se <- list(sqrt(diag(vcovHC(cig_ols, type = "HC1"))),
sqrt(diag(vcovHC(cig_ivreg, type = "HC1"))))
# Show result
stargazer(cig_ols, cig_ivreg, type ="text", se = rob_se)
# First stage regression
result_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestax + cigtax , data= Cigdata)
# F test
linearHypothesis(result_1st,
c("salestax = 0", "cigtax = 0" ),
vcov = vcovHC, type = "HC1")
library(readr)
HGdata <- read_csv("HansfordGomez_Data.csv")
stargazer::stargazer(as.data.frame(HGdata), type="text")
hg_ols <- lm( DemVoteShare2 ~ Turnout + factor(Year)   ,  data = HGdata)
coeftest(hg_ols, vcov = vcovHC, type = "HC1")
# You can do this, but it is tedious
hg_ols <- lm( DemVoteShare2 ~ Turnout + Yr52 + Yr56 + Yr60 + Yr64 +
Yr72 + Yr76 + Yr80 + Yr84 + Yr88 + Yr92 + Yr96 + Yr2000,  data = HGdata)
coeftest(hg_ols, vcov = vcovHC, type = "HC1")
# You can do this, but it is tedious
hg_ols <- lm( DemVoteShare2 ~ Turnout + Yr52 + Yr56 + Yr60 + Yr64 + Yr68 +
Yr72 + Yr76 + Yr80 + Yr84 + Yr88 + Yr92 + Yr96 + Yr2000,  data = HGdata)
# You can do this, but it is tedious
hg_ols <- lm( DemVoteShare2 ~ Turnout + Yr52 + Yr56 + Yr60 + Yr64 + Yr68 +
Yr72 + Yr76 + Yr80 + Yr84 + Yr88 + Yr92 + Yr96 + Yr2000,  data = HGdata)
coeftest(hg_ols, vcov = vcovHC, type = "HC1")
# By using "factor(Year)" as an explanatory variable, the regression automatically incorporates the dummies for each value.
hg_ols <- lm( DemVoteShare2 ~ Turnout + factor(Year)   ,  data = HGdata)
# Iv regression
hg_ivreg <- ivreg( DemVoteShare2 ~ Turnout + factor(Year) |
factor(Year) + DnormPrcp_KRIG, data = Cigdata)
# Iv regression
hg_ivreg <- ivreg( DemVoteShare2 ~ Turnout + factor(Year) |
factor(Year) + DnormPrcp_KRIG, data = HGdata)
# Iv regression
hg_ivreg <- ivreg( DemVoteShare2 ~ Turnout + factor(Year) |
factor(Year) + DNormPrcp_KRIG, data = HGdata)
coeftest(hg_ivreg, vcov = vcovHC, type = "HC1")
# Robust standard errors
rob_se <- list(sqrt(diag(vcovHC(hg_ols, type = "HC1"))),
sqrt(diag(vcovHC(hg_ivreg, type = "HC1"))))
# Show result
stargazer(hg_ols, hg_ivreg, type ="text", se = rob_se)
# First stage regression
hg_1st <- lm(log(rprice) ~ log(rincome) + log(rincome) + salestax + cigtax , data= Cigdata)
# F test
linearHypothesis(hg_ivreg,
c("salestax = 0", "cigtax = 0" ),
vcov = vcovHC, type = "HC1")
# First stage regression
hg_1st <- lm(Turnout ~  factor(Year) + DNormPrcp_KRIG, data= Cigdata)
# First stage regression
hg_1st <- lm(Turnout ~  factor(Year) + DNormPrcp_KRIG, data= HGdata)
# F test
linearHypothesis(hg_1st,
c("salestax = 0" ),
vcov = vcovHC, type = "HC1")
# F test
linearHypothesis(hg_1st,
c("DNormPrcp_KRIG = 0" ),
vcov = vcovHC, type = "HC1")
# You can do this, but it is tedious.
hg_ols <- lm( DemVoteShare2 ~ Turnout + Yr52 + Yr56 + Yr60 + Yr64 + Yr68 +
Yr72 + Yr76 + Yr80 + Yr84 + Yr88 + Yr92 + Yr96 + Yr2000,  data = HGdata)
coeftest(hg_ols, vcov = vcovHC, type = "HC1")
# By using "factor(Year)" as an explanatory variable, the regression automatically incorporates the dummies for each value.
hg_ols <- lm( DemVoteShare2 ~ Turnout + factor(Year)   ,  data = HGdata)
coeftest(hg_ols, vcov = vcovHC, type = "HC1")
# Iv regression
hg_ivreg <- ivreg( DemVoteShare2 ~ Turnout + factor(Year) |
factor(Year) + DNormPrcp_KRIG, data = HGdata)
coeftest(hg_ivreg, vcov = vcovHC, type = "HC1")
# Robust standard errors
rob_se <- list(sqrt(diag(vcovHC(hg_ols, type = "HC1"))),
sqrt(diag(vcovHC(hg_ivreg, type = "HC1"))))
# Show result
stargazer(hg_ols, hg_ivreg, type ="text", se = rob_se)
# First stage regression
hg_1st <- lm(Turnout ~  factor(Year) + DNormPrcp_KRIG, data= HGdata)
# F test
linearHypothesis(hg_1st,
c("DNormPrcp_KRIG = 0" ),
vcov = vcovHC, type = "HC1")
library("MASS")
library("dplyr")
library("AER")
N = 500
Mu = c(1,2)
Sigma12 = matrix( c(1, 0.9, 0.9, 1), nrow = 2, ncol = 2)
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
rho = 0.2
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
y = 1 + 2*x + error
cor(x,z)
rho = 0.1
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
corr(x, z)
cor(x, z)
x <- rho*z + 0.5*error
cor(x, z)
rho = 0.05
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cor(x, z)
rho = 0.05
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
rho = 0.5
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
rho = 0.5
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 2)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + 0.5*error
cov(x, z)
Var(x)
var(c)
var(x)
var(z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
corr(x,z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
N = 2000
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
N = 500
Mu = c(1,2)
Sigma12 = matrix( c(1, 0.9, 0.9, 1), nrow = 2, ncol = 2)
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
for (i in 1:1000){
rho = 0.5
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
y = 1 + 2*x + error
data <- data.frame(  x = x,
y = y,
z = z)
result <- lm( y ~ x, data = data)
result_vec1[i] <- result$coefficients[2]
result <- ivreg( y ~ x | z, data = data)
result_vec2[i] <- result$coefficients[2]
}
summary(result_vec1)
summary(result_vec2)
result_data <- data.frame(  B_OLS = result_vec1,
B_IV = result_vec2 )
data_for_plot <- melt(data = result_data, variable.name = "Variable" )
library("reshape")
library("ggplot2")
result_data <- data.frame(  B_OLS = result_vec1,
B_IV = result_vec2 )
data_for_plot <- melt(data = result_data, variable.name = "Variable" )
fig <-
ggplot(data = data_for_plot) +
xlab("Sample mean") +
geom_line(aes(x = value, colour = variable ),   stat = "density" )
plot(fig)
N = 500
Mu = c(1,2)
Sigma12 = matrix( c(1, 0.9, 0.9, 1), nrow = 2, ncol = 2)
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
for (i in 1:1000){
rho = 0.1
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
y = 1 + 2*x + error
data <- data.frame(  x = x,
y = y,
z = z)
result <- lm( y ~ x, data = data)
result_vec1[i] <- result$coefficients[2]
result <- ivreg( y ~ x | z, data = data)
result_vec2[i] <- result$coefficients[2]
}
summary(result_vec1)
summary(result_vec2)
result_data <- data.frame(  B_OLS = result_vec1,
B_IV = result_vec2 )
data_for_plot <- melt(data = result_data, variable.name = "Variable" )
fig <-
ggplot(data = data_for_plot) +
xlab("Sample mean") +
geom_line(aes(x = value, colour = variable ),   stat = "density" )
plot(fig)
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
for (i in 1:1000){
rho = 0.2
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
y = 1 + 2*x + error
data <- data.frame(  x = x,
y = y,
z = z)
result <- lm( y ~ x, data = data)
result_vec1[i] <- result$coefficients[2]
result <- ivreg( y ~ x | z, data = data)
result_vec2[i] <- result$coefficients[2]
}
summary(result_vec1)
summary(result_vec2)
library("reshape")
library("ggplot2")
result_data <- data.frame(  B_OLS = result_vec1,
B_IV = result_vec2 )
data_for_plot <- melt(data = result_data, variable.name = "Variable" )
fig <-
ggplot(data = data_for_plot) +
xlab("Sample mean") +
geom_line(aes(x = value, colour = variable ),   stat = "density" )
plot(fig)
result
result$model
sqrt(diag(vcovHC(cig_ols, type = "HC1")))
sqrt(diag(vcovHC(result, type = "HC1")))
result_vec1[i] <- result$coefficients[2]/robse[2]
for (i in 1:1000){
rho = 0.2
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
y = 1 + 2*x + error
data <- data.frame(  x = x,
y = y,
z = z)
result <- lm( y ~ x, data = data)
result_vec1[i] <- result$coefficients[2]
robse <- sqrt(diag(vcovHC(result, type = "HC1")))
result_vec1[i] <- result$coefficients[2]/robse[2]
result <- ivreg( y ~ x | z, data = data)
result_vec2[i] <- result$coefficients[2]
robse <- sqrt(diag(vcovHC(result, type = "HC1")))
result_vec2[i] <- result$coefficients[2]/robse[2]
}
summary(result_vec1)
summary(result_vec2)
result
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
for (i in 1:1000){
rho = 0.2
error <- rnorm(N, mean = 0, sd = 1)
z <- rnorm(N, mean = 1, sd = 1)
x <- rho*z + sqrt(1-rho^2)*error
cov(x, z)
cor(x,z)
y = 1 + 2*x + error
data <- data.frame(  x = x,
y = y,
z = z)
result <- lm( y ~ x, data = data)
result_vec1[i] <- result$coefficients[2]
robse <- sqrt(diag(vcovHC(result, type = "HC1")))
result_vec1[i] <- result$coefficients[2]/robse[2]
result <- ivreg( y ~ x | z, data = data)
result_vec2[i] <- result$coefficients[2]
robse <- sqrt(diag(vcovHC(result, type = "HC1")))
result_vec2[i] <- result$coefficients[2]/robse[2]
}
summary(result_vec1)
summary(result_vec2)
robse
result$coefficients
data <- data.frame(  y = y,
xobs1 = xobs1,
xobs1 = xobs1 )
N = 500
result_vec1 = numeric(1000)
result_vec2 = numeric(1000)
for (i in 1:1000){
error <- rnorm(N, mean = 0, sd = 1)
xtrue <- rnorm(N, mean = 1, sd = 2)
xobs1 <- xtrue + rnorm(N, mean = 0, sd = 1)
xobs2 <- xtrue + rnorm(N, mean = 0, sd = 1.5)
y = 1 + 2*xtrue + error
data <- data.frame(  y = y,
xobs1 = xobs1,
xobs2 = xobs2 )
result <- lm( y ~ xobs1, data = data)
result_vec1[i] <- result$coefficients[2]
result <- ivreg( y ~ xobs1 | xobs2, data = data)
result_vec2[i] <- result$coefficients[2]
}
summary(result_vec1)
summary(result_vec2)
library("reshape")
library("ggplot2")
result_data <- data.frame(  B_OLS = result_vec1,
B_IV = result_vec2 )
data_for_plot <- melt(data = result_data, variable.name = "Variable" )
fig <-
ggplot(data = data_for_plot) +
xlab("Sample mean") +
geom_line(aes(x = value, colour = variable ),   stat = "density" )
plot(fig)
library(readr)
RyanData <- read_csv("cementDec2009.csv")
stargazer::stargazer(RyanData)
stargazer::stargazer(RyanData, type = "text")
stargazer::stargazer(as.data.frame(RyanData), type = "text")
RyanData %>%
select(year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
RyanData %>%
select(year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
RyanData %>%
select(year) -> RyanData
RyanData %>%
dplyr::select(year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
library(readr)
library(dplyr)
library(stargazer)
RyanData <- readr::read_csv("cementDec2009.csv")
RyanData %>%
dplyr::select(year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
stargazer::stargazer(as.data.frame(RyanData), type = "text")
RyanData <- readr::read_csv("cementDec2009.csv")
RyanData %>%
dplyr::select(year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
stargazer::stargazer(as.data.frame(RyanData), type = "text")
RyanData <- readr::read_csv("cementDec2009.csv")
names(RyanData)
RyanData %>%
dplyr::select(region, year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
stargazer::stargazer(as.data.frame(RyanData), type = "text")
RyanData <- readr::read_csv("cementDec2009.csv")
RyanData %>%
dplyr::select(region, year, shipped, price, wage96, coal96, elec96, population, gas96) -> RyanData
stargazer::stargazer(as.data.frame(RyanData), type = "text")
RyanData$region
unique(RyanData$region)
length(unique(RyanData$region))
